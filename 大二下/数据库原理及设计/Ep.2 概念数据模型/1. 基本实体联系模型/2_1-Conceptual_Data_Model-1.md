# 第一节 基本实体联系模型

## 一、 E-R模型对数据结构的描述

### 1.

#### 1. 数据结构的基本概念

* 实体 (Entity)：  
  现实世界中有区别于其他对象的对象。  
  可以是具体的也可以是抽象的。
  > e.g. 某位学生、某个课程。
* 实体型 (Entity set)：  
  属于**同类**的所有实体的**集合**。  
  一个实体集中所有实体具有**相同的属性**。
* 属性 (Attribute)：  
  实体的**特征或性质**。  
  实体用属性描述。
  > e.g. 学生的姓名、生日等。

  分类：
  * 按结构分类
    * 简单属性：不可再分的属性。
    * 复合属性：可以被划分为更小的子属性。
      > e.g. 住址（可被划分为省、市、区等）、身份证号、姓名
  * 按取值分类
    * 单值属性：只有一个取值（如：学号）。
    * 多值属性：可以有多个取值（如：学位，可以有多个学位）。
    * 导出属性：从另一个属性得到的属性（如：从生日可以得到年龄）。
    * 空值属性：值不确定或者无值的属性（如：书籍的附件属性可以为空、在校大学生的学位）。
* 域 (Domain)：  
  属性的**取值范围**称为域。
* 键 (Key)：  
  具有唯一标识特性的一个或一组属性，用于唯一标识一类实体集中的实体。也称“唯一约束”。
  > e.g. 学生（实体）的学号（唯一标识属性）

  分类如下：
  1. 键的属性构成
     * 简单键：由一个属性构成。
     * 复合键：有多个属性构成。
  2. 键
     * 超键：能唯一标识实体的**属性集合**。
       > e.g. 虽然姓名不是键，但{学号}、{学号, 姓名}等等是超键。
     * 候选键：能唯一标识实体的**最小属性集合**。  
       > e.g. 只有学号姓名是，为{学号}；多了身份证号时，为{学号}和{身份证号}
     * 全键：能唯一标识实体的**最大属性集合**，包含所有属性。
     * 主键：在候选键中，选择一个作为主键。

ER模型通实体型和属性来描述实体。

#### 2. 实体的ER图表示方法

* 矩形 - 实体集
* 椭圆 - 属性  
  * 主键属性用下划线标出
  * 导出属性用虚线椭圆
  * 多值属性用双椭圆
  * 复合属性则在该椭圆下再用椭圆标出组成的属性
  
### 2. 对实体间联系的描述

* 联系：两个或多个实体键的关联。  
  同样的实体型间可以存在多个联系。
* 联系的属性

*实体集是名词，联系是动词。*

* 联系型 (Relationship Set)：同一类的一组联系。
* 联系型的阶 (Degree)：一个联系所关联的实体的数量，称为$n$元联系。
  * 一元联系：学生中管理的联系、零件中装配的联系。
  * 二元联系：学生与课程间选课的联系。
  * 三元联系：售货员、商品、客户间零售的联系。

ER图用菱形表示联系，椭圆表示联系的属性。

## 三、数据约束描述

### 1. 一般性约束

存在实体集$A$和$B$，其间的联系集为$R$。

* 一对一约束$1:1$：$A$中的一个实例，与$B$中的实例一一对应。  
  如：妻子与丈夫间结婚的联系，学校与校长间主持的联系
* 一对多约束$1:n$：$A$中一个实例，$B$中有$n(n\ge0)$个实例对应；但$B$中一个实例，$A$中只有一个实例对应。  
  如：父母与孩子的联系，学校与教师间工作的联系。  
  注意存在顺序，根据题目可能是多对一的联系。
* 多对多约束$n:m$  
  如：学生与课程间选课的联系。

在ER图上则在联系上用$1$和$n,m$，标出一般性约束。

只是代表数量上的约束。

### 2. 键约束

如果在一个联系R的实例中，所关联的实体A最多只能出现在一个联系实例中，它就可以唯一确定该联系。  
有些教材中也称为“实体对应约束”。

* 对于一对多：一般为标$n$的为“实体对应约束”。
* 对于一对一：两个都为“实体对应约束”。

表示方法，对“实体对应约束”的实体与联系间的线加上箭头。
> 若联系有属性的时候，可以不为键约束，此时可加可不加。

好处：实体能够代表联系，因此转化的时候可以少转化联系的表。  
拓展：多实体间的联系也存在键约束。

### 3. *参与约束

实体参与联系的数量。

ER图中用$(min,max)$表示

* 完全参与  
  如教师和大学间工作的联系，教师肯定工作于大学，大学给教师提供工作。  
  即为$(n,...)(n\ge1)$

  ER图的线加粗表示。
* 部分参与
  如教师和课程间授课的联系，教师不一定全部都授课。  
  即为$(0,...)$

### 4. 弱实体约束

> 定义 - 弱实体：
>
> 没有键属性的实体型为弱实体型，存在键属性的实体型为强实体型。

虽然现实世界不可能存在没有主键的实体，  
但如果在数据库设计中不需要在意某实体的主键，则会出现弱实体。

如：学校系统中对于学生的监护人，可能只需要监护人的姓名，因此监护人为弱实体，必须依赖于学生来确定。

因此弱实体必须与强实体配对，即与强实体之间要存在联系，  
**该联系只能为$1:1$或$1:n$联系**，称为弱实体的“识别联系”。

弱实体存在部分键，也能区分不同弱实体，但可能存在冲突。（如姓名）

ER图中：  
识别联系用粗线条。  
部分键加虚下划线。