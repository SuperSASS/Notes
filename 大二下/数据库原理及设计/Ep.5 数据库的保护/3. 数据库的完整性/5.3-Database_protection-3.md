# 第三节 数据库的完整性

## 一、完整性的概念

* 数据的正确性：数据要符合现实世界的语义。  
  对于“年龄”这一属性，必须为正整数。
* 数据的相容性：数据库同一对象在不同关系表中的数据是符合逻辑的。  
  即学号在许多表里都要有，要保持同步。

**目标：**  

* 防止不存在不符合语义的数据
* 要允许数据相容。

## 二、RBDMSd对数据完整性的支持

1. 提供定义“完整性约束条件”的机制  
   通过DDL定义的约束。
2. 提供完整性检查方法  
   在数据更新（增删改）时检查约束。
3. 违约处理  
   如果不满足约束，可处理的策略有级联和拒绝。

## 三、完整性的约束类型

* 数据库完整性
  * 静态完整性约束（状态约束）  
    没有时间关系，只是当前某一瞬间的检查。
    * 固有约束 - 原子性  
      属性是原子的，不可再分。
    * 隐式约束 - `RULE`  
      作用在**一个关系**上的某些属性上。
    * 显示约束  
      一个关系中某些值与另一些关系中某些值的比较，**跨关系**。
      * 过程化定义
      * 断言  
        指的是数据库状态应满足的逻辑条件。
      * 触发器

      断言与触发器的区别在于：  
      断言只需要给条件，检查就根据条件系统自动检查。  
      但触发器完全由自己编程，如何检查也要自己写。
  * 动态完整性约束（变迁约束）  
    数据**变化前后情况**的关系约束。

### 3. 完整性约束的验证与实施

约束将在何时起作用？​

* 固有约束的验证：由DBMS自动完成。​
* 隐式约束：当数据更新时，由DBMS按相应约束条件自动完成。​
* 显式约束：
  1. 过程方式的定义约束仍需开发人员编写验证过程
  2. 断言方式定义的约束由DBMS的ICS负责验证
  3. 触发器方式定义的约束由DBMS负责完成
* 动态约束：
  1. 过程方式的定义约束仍需开发人员编写验证过程
  2. 触发器方式定义的约束由DBMS负责完成