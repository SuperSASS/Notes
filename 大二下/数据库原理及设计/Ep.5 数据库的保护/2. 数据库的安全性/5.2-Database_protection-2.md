# 第二节 数据库的安全性

## 一、数据库的安全性概况

非法使用数据库的情况：

* 编写合法程序绕过DBMS及其授权机制。
* 直接或编写应用程序执行非授权操作。
* 通过多次合法查询数据库从中推导出一些保密数据。

> 定义 - 数据库的安全性
>
> 指保护数据库，防止不合法的使用，以免数据的泄密、更改或破坏。

DBMS与OS在安全上的关系：

* DBMS的安全建立在OS的安全之上，若OS不安全，则DBMS安全性也难以保障。  
  比如OS有漏洞，能直接让别人删除存储在硬盘上的数据库物理文件。
* 除了OS的安全屏障外，DBMS为加强其安全性，应建立自己的安全体系。

## 二、数据库的安全性控制

### 1. 用户标志与鉴别

是系统提供的最外层的安全保护措施。

就是账户密码。

### 2. 存取控制

* 定义用户权限
* 合法权限检查

常用存取控制方法：

* 自主存取控制(Discretionary Access Control, DAC)  
  直接给某个用户一定的权限。
* 强制存取控制(Mandatory Access Control, MAC)  
  将数据对象标以一定**密级**，每一用户对应某一级别的许可证。  
  相当于SPC的D级人员

一般采用DAC。

## 三、自主存取控制

对于数据库，分为不同粒度，为横轴：

* DB
  * 表
    * 列
    * 约束
    * 元组
  * 视图

有不同操作，为纵轴：

* INSERT
* UPDATE
* DELETE
* SELECT

给予不同用户，对什么粒度，进行什么操作的权限。

即存取权限由两个要素组成：

* 数据对象
* 操作类型

通过SQL的`GRANT`和`REVOKE`来实现。

### 1. GRANT - 授权

```sql
GRANT <权限> ON <表名>
  TO <授权者>[,...]
  [WITH GRANT OPTION] -- 可以再授权下去
```

```sql
<权限>::==
  ALL PRIVILEGES | <操作>[,...]

<操作>::==
  SELECT | INSERT | DELETE | UPDATE [(<列名>)]

<授权者>::==
  PUBLIC | <用户>
```

**能发出授权的用户：**

* DBA - 数据库管理员
* DBO - 数据库对象创建者
* 拥有该权限的用户

```sql
/* 授权Student所有权限给User1用户 */
GRANT ALL PRIVILIGES ON Student TO User1;
```

### 2. REVOKE - 撤权

```sql
REVOKE <权限>[,...]
  ON <对象类型><对象名>
  FROM <用户>[,...]
```

> e.g.
>
> ```sql
> REVOKE UPDATE(Sno)
>   ON TABLE Student
>   FROM User1
> ```

### 3. 创建用户

```sql
CREATE USER <用户名>
  [WITH] [DBA | RESOURCES | CONNECT]
```

### 4. 创建角色

是授权的集合，相当于给用户分组，  
在用户特别多的时候，可以不必一个个取授权，简化操作。

```sql
/* 创建角色范式 */
CREATE ROLE <角色名>
```

```sql
/* 给角色授权范式 */
GRANT <权限>[,...]
  ON <对象类型><对象名>
  TO <角色>[,...]
```

跟给用户授权一样。

```sql
/* 将角色授权给用户或其他角色 */
GRANT <角色>[,...]
  TO { <角色> | <用户> }[,...]
  [WITH ADMIN OPTION]
```

```sql
/* 角色权限的收回 */
REVOKE <权限>[,...]
  ON <对象类型><对象名>
  FROM <角色>[,...]
```

## 四、SQL Server安全体系

三道门：

```
sp_login @username()
```

1. 先登录服务器
2. 进入数据库管理系统
3. 获得...

## 五、数据库安全的其他内容

### 1. 加密

### 2. 审计跟踪

监视机制

### 3. 统计数据库安全

`