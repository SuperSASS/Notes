# 第二节 主存储器的组织

## 一、主存储器的基本结构

主存通常由存储体、地址移码驱动电路、I/O、读写电路四部分组成（对于动态存储器还有刷新电路）。  

## 二、主存储器的存储单元

### 1. 基本概念

* 位(bit, b)：**存储器**信息**存储的最小单位**。  
  就是一位二进制数，只有`0`或`1`
* *字节*(byte, B)：就八位一字节。  
  如：`0000_0000`、`1101_0110`。
* 存储字（字）：可作为一个整体存入或取出的二进制位数。  
  如32位计算机，存储字至少为32位。
* 存储单元：**CPU**对主存可**访问的最小单位**。
* 存储地址：每个**存储单元的编号**称为（存储）地址。​

关系：$1$字→若干字节→$8$位

### 2. 地址编排方式

1. 按位编址
2. **按字节编址**
3. 按字编址

### 3. 按字节编址时的字地址

两种方案：

1. 大端方案
2. **小端方案**（现在常用）  
   字地址等于最低有效字节地址。  
   即：**低字节在前**。

> e.g. - 一个字`A0_3C_7F_FF`：
>
> * 大端方案存储：`A0_3C_7F_FF`。
> * 小端方案存储：`FF_7F_3C_A0`。

但注意只是**对数据**来说用**小端方法**，  
对于**操作指令**一般还是**直接存放**（相当于大端方案）​。

## 三、数据在主存中的存放

对于**按字节编址**时，数据在主存中有三种存储方法：

### 1. 紧缩存放

各种不同长度的数据，紧挨着存放。

* 优点：不浪费主存资源
* 缺点：可能会增加访存次数，且读写控制困难。  
  一个字节或半字可能跨两个空间，因此两个都要读，且还要各取部分组合。

### 2. 存储字字边界存放  

一个数据占用一个存储字长。

* 优点：读写速度快，控制简单。
* 缺点：浪费主存资源。

### 3. 整数边界存放  

为前两种方法的折中。  
数据在满足只访存一次的前提下，尽量紧挨存放。  

方式：

* 对于字节：最末两位只能是`00`。
* 对于半字：最末一位只能是`0`。
* 对于字和双字：任意存放（因为长度已经大于等于存储字长）。

---

由于各个硬件平台对存储空间的处理上有很大不同，  
因此需要按平台要求，对数据存放进行对齐，否则损失存储效率。
> 如：
>
> 32系统的`int`型，  
> 如果放在偶地址开始的地方，则一个读周期可以读出；  
> 如果放在奇地址开始的地方，则需要两个周期，且需要拼接。

编写高级语言的时候，编译器会根据平台，自动选择对齐方式。

高级语言中手动更改方式：

1. 代码中声明：  

   ```c++
   int main(...)
   {
     #pragma pack(2) //必须声明在函数里。
   }
   ```

2. 在开发环境中设置：  
   设置 - 结构成员对齐。

## 四、存储器的主要技术指标

### 1. 存储容量

以“字节编址”的计算机：
以“字编址”的计算机：

* 系统上：$1$MB=$1024$KB
* 硬盘容量上：$1$MB=$1000$KB

区别 - KiB/MiB与KB/MB区别：

### 2. 存取速度

* 存取时间$T_a$
* 存取周期$T_m$
* 主存带宽$B_m$

### 3. 其他指标

* 可靠性
* 功耗
* 性价比
