# Ep.1 概述

## 一、什么是分布式系统

是一个**自治计算元素的集合**，组成的**单连贯系统**。

### 1. 自主计算元素（节点）

可以是硬件的**设备**、也可以是软件的**进程**。

* 要求节点有**独立行为**，故都有自己的时间概念，没有全局时钟，导致同步和协调的问题。
* 节点集合如何管理、如何进行授权（安全）

**怎么组织节点 —— 覆盖网络**：
物理上的网络已经定义好了，但通过覆盖网络可以组成任意自己想要的网络。

* 结构化的：每个节点都有一组定义明确的邻居，可以与之通信（树、环）。
* 非结构化的：每个节点都引用了从系统中随机选择的其他节点。

### 2. 单连贯系统

用户或应用程序感知不到节点，而感知为单个系统。故要求节点间通信。

无论用户与系统的交互在何处、何时、何地发生，节点集合作为一个整体的运行、结果都是相同的。

用户不知道计算、存储发生的位置，具体内部的细节（如数据复制）

**关键问题 —— 部分故障**：
经常会出现分布式系统的一部分出现故障，通常方式是将坏的部分隐藏起来，但实现很困难。

## 二、设计目标

1. 支持资源共享
2. 使分布透明
   * 访问资源
   * 存储位置
   * 重定位（移动一个对象不影响使用）
   * 迁移
   * 复制
   * 并发（多个用户同时用一个对象）
   * 失效（部分坏了，整体不坏）

   完全分布透明成本很高：
   * 存在无法隐藏的通信延迟
   * 无法区分运行缓慢和出现故障的计算机
   * 并且无法确定服务器崩溃前是否有操作
   * 完全透明将牺牲性能（如同步的要求）

   且有时候不透明、公开分布可能更好，如：
   * 基于位置的服务（如查找附近的人）
   * 与不同时区的用户打交道
   * 能让用户更轻松地了解正在发生的事情

   故虽然理论上越透明越好，但实现上通常不以其为目标。
3. 保持开放
   * 对上（App），提供明确的接口
   * 对下（OS），易于胡操作、有可移植性
   * 整体，可扩展

   通常将策略（做什么）和机制（怎么做）分离，平台提供机制，用户选择策略。
4. 可伸缩
   至少三个组件：
   * 大小可伸缩性：用户 / 进程数
     但用户特别多，响应指标也可满足。
   * 地理可伸缩性：节点最大距离
     WAN 本质上不可靠，不能简单将 LAN 转为 WAN
   * 管理可伸缩性：管理域数
     使用、管理和安全性的冲突策略

   技术：
   * 利用异步通信
   * 为每个响应用单个程序处理
   * 将部分功能放到客户端

   问题 - 复制：
   可伸缩通常会进行复制，会导致不一致性问题。
   全局同步很困难，通常根据应用场景可以容忍一定的不一致（比如聊天应用）。
5. 陷阱
   会做出很多错误假设，如：
   * 网络可靠安全
   * 拓扑不会更改
   * 延迟为零
   * 运输成本为灵

   需要避免这些陷阱。

## 三、分布式系统的类型

1. **高性能分布式计算**
   只用于计算。归于服务器类。
2. **分布式信息系统**
   用于信息交流交互、如交易。
   核心是**事务**(Transaction)，有**四个特点**(ACID)：
   * Atomic - 原子
   * Consistent - 一致
   * Isolated - 隔离
   * Durable - 永久
3. **泛在系统**
   在哪里都可以用该系统，连接物理世界，如物联网。