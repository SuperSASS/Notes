# Ep.4 过程式程序设计语言

过程式语言（强调逻辑流程），也称为“命令式 / 强制(imperative)式”语言（强调如何修改机器内部的状态，让他按照我的思维方式进行）。

这种语言的组织范式为：**算法过程（计算控制）+数据结构（计算对象）**。

## 一、计算对象表示——值与类型

机器只能用01串去表征这个世界，所以人脑中的概念如何对应到机器中（如何表示），以及机器如何解释（如何解析）。

类型是计算机可能实现的结构、和对客观世界的刻画。  
表明如何解释符号串、以及如何操作。  
相同的类型，表示相同的结构、相同的语义解释、相同的操作。

* 基元类型(primitive)：整型、实数（定点数、浮点数）、字符、布尔、枚举  
  表达了基础的操作、解决了执行中的效率问题（
* 结构类型(structed)：结构体……

### 1. 标识符 - 字面量、变量、常量

**标识符（名字）**：

用标识符来操作值（字面量、变量、常量）。  
在命令式语言中，基元值的标识符是**地址**的别名，其具体的地址值（不是地址指向的值）在计算机中恒定不变。  
操作地址的标识符称为“指针”。

**左值、右值**：

因为标识符为地址的别名，所以根据标识符在表达式的位置：

* 左值 - 放在表达式左侧：表达标识符代表的**空间**
* 右值 - 放在表达式右侧：表达标识符空间中的值

**别名**：

多个变量可以共同指向一个地址时，多个变量名访问单个存储地址时，这些变量名为别名。  
并没有违反二义性原则。

### 2. 值是头等程序对象（一等公民）

一等公民：可以用统一的一套规则，对这个程序对象进行操作。  
具有特性：

* 能作为输入的参数、或作为返回值
* 可单独存储
* 可出现在表达式中、并求值

**表达式求值方法**：

表达式中求值靠**运算符**，
运算符可以当作一种特殊的函数。  
*因此函数没有参数个数限制，则运算符也可以有多目运算。*

**基本类型的操作**：

即基本类型$T$的映射

1. $T\to T$ - 基本类型直接映射到基本类型
2. $T\oplus T\to T$ - 基本类型通过与同样的基本类型操作，映射到同样的基本类型

**复合类型**：

* 笛卡儿积：元组
* 不相交联合

**映射**：

从一个类型得到另一个类型，  
函数是映射的具体算法实现。

数组相当于一个映射（从下标映射到某个值）。  
数组要考虑的问题有：

* 哪些类型对于下标合法
* 要对元素引用中的下标表达式检查其范围吗
* 何时绑定下标范围
* 何时进行数据存储空间的分配
* 支持不规则数据或多维数据吗
* 是否支持数组元素异构
* 数组能否分片，如果可以是哪种类型的片数组

**递归类型**：

* 表：底层为幂集
* 串

### 3. 类型系统

* 类型定义：值的集合+值上操作的集合（V, Op）
* 类型系统
* 类型规则

**类别**：

* 静态与动态
* 弱 / 强类型
  * 无类型：如 Lisp（标识符就是个符号）, Smalltalk（所有的都认为是对象）
  * 弱类型：有类型，但类型兼容性大、系统不做检查，如 VB
  * 强制类型：会长治进行隐形类型转换（类型升级）
  * 位强类型：静态均有类型且会做检查，但并不严，可以推出类型等价，如 Pascal, C
  * 强类型：类型均有严格定义、且会检查，如 Ada（会给整形定义一个取值范围）

**类型等价**：

* 按结构等价：从底层判断是否等价
* 按名等价：按照人的逻辑去判断

**类型兼容**：

希望不同类型的数据也能计算，  
有隐式和显式类型转换。

## 二、计算对象表示——存储

存储对象是程序对象在计算机中实现。

需要存储的对象：

* 已解释的用户程序代码段
* 系统运行时程序
* 子程序返回点
* 临时变量
* 输入输出缓冲
* ……

### 1. 程序变量的时空特性

#### (1) 变量的时态

* 有关分配
  * 分配
    * 静态分配
    * 动态分配：new
  * 未分配
  * 除分配：delete
  * 自动分配：GC
* 有关定义

#### (2) 存储管理方式

* 栈：栈具有封闭性，自己的栈对别人不可见（所以不能信息交换）
* 堆：开放性

### 2. 存储模型

**可存储值**：指最小的可直接访问的可存储单元中的值。

头等程序对象都需要可存储。

#### (1) 存储对象生存期

按生命周期区分：

* 全局变量
* 局部变量
* 持久变量
* 瞬间变量

**静态语言与动态语言**：

* 静态：在编译后就确定了变量分配，如 C
* 动态：直到对象装载进来才能确定分配，如 Java、Python

**静态存储对象**：

一旦执行不再改动其存储（指的是位置、生命周期等，而非值），直到所在存储单元无效。
对应关键词`static`。

全局变量均为隐式的静态对象。  
`auto`是静态分配动态装入、不是静态存储对象。  
`extern`是静态对象。

**堆栈帧**：

描述一个栈最基本的结构，如参数、返回地址、**动态链**（调用块的首地址）、**静态链**（父辈、谁调用的）、返回值、局部变量。
*对于动态链和静态链理解可能有误。*

### 3. 悬挂引用

引用丢失。

## 三、计算对象表示——束定（绑定, binding）

应该是将标识符与值联系到一起。

### 1. 静态束定

多重束定，即`union`

### 2. 动态束定

### 3. 无类型语言的束定

### 4. 声明

* 顺序申明
* 并行申明

### 5. 声明作用域

* 块
* 可见性

动态作用域、静态作用域。

## 四、计算组织——程序控制

## 五、计算组织——函数与过程

## 六、计算组织——抽象与封装
