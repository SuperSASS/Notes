# 最优化初步

## 可行方向

$$
\underset{\boldsymbol{x}\in S}{\text{min}}f(\boldsymbol{x})
$$

* **可行方向**：对于一点$\boldsymbol{x}$和一方向向量$\boldsymbol{d}$，如果从$x$向$d$方向存在一小段线段在$S$内部，则称该方向向量为"可行方向"  
  可以将多元函数的极值问题转换为一元函数$\phi(\alpha)=f(x_*+\alpha d)\quad(0\le\alpha\bar{\alpha})$

**一阶必要条件**：

对于上式，当$\alpha=0$时，为$\phi(\alpha)$在$[0,\bar\alpha]$上的局部极小值，即$\phi'(0)\ge0$（此时$\alpha$不一定是内点，故大于等于0）  
$\phi'(\alpha)=\nabla f(x_*)^T\boldsymbol{d}$

**特例（但通常适用）**——$x_*$是内点：则任意可行方向$\phi'(\alpha)\ge0$，故可以推出$\phi'(\alpha)=0$，即$\nabla f(x_*)=0$，为驻点。

**二阶必要条件**：

首先包含一阶条件，  
然后当一阶条件$=0$时，则要求$\phi(\alpha)$二阶导数$\boldsymbol{d}^T\nabla^2f(\boldsymbol{x}_*)\boldsymbol{d}\ge0$

**特例（但通常适用）**——$x_*$是内点：则任意$\boldsymbol{d}$都满足，故$\nabla^2f(\boldsymbol{x}_*)$矩阵为半正定。

**二阶充分条件（内点情况）**：

> 如果$x_*\in \text{int}S$，且$\nabla f(x_*)=0, \nabla^2f(x_*)\ge0$，  
> 则$x_*$为$f$的严格局部极小点。

## 算法

迭代$x$。

算法要求：

1. 能稳定地接近局部极小点（想要的理想点，如驻点、KKT点）$x_*$
   * 每次迭代后目标值减小
   * $\{x_k\}$的聚点是驻点或KKT点
2. 迅速
   * 引入误差度量$\delta(x)$
   * 利用误差序列$q=\delta_{k_1}/\delta_k$（$q=[0,1]$）确定速度：
     * 线性收敛
     * 超线性收敛$q=0$，收敛比线性更快
     * 次线性收敛$q=1$，收敛比线性更慢
     * 二次收敛

**终止准则**：

* 理想
* 实际

### 线搜索法

更新为$x_{k+1}=x_k+\alpha_k d_k$，  
其中$\alpha_k$为步长、$d_k$为方向。

要点：

1. 确定搜索方向：必须是下降方向
2. 确定步长（下降量）：
   * 精确线搜索
   * 非精确线搜索：容易造成失败（收敛过慢、收敛错误、振荡）  
     准则：尽可能避开$(0,\bar\alpha)$的端点  
     提出$\rho$线，基于 Armijo 条件（保证步长不会太大，不靠近右侧），有两种方法：
     * Goldstein 测验 - 保证步长不太小，不靠近 0（存在缺陷）
     * Armijo 法则