# Ep.4 æ¢¯åº¦ä¸‹é™æ³•(GD)

æ˜¯çº¿æœç´¢æ³•æ ¼å¼ä¸­ï¼Œç¡®å®š**æœç´¢æ–¹å‘**$\boldsymbol{d}_k$çš„ä¸€ç§æ–¹æ³•ã€‚  
$\phi(\alpha)=f(\boldsymbol{x}_k+\alpha\boldsymbol{d}_k)$ã€‚

## ä¸€ã€æ–¹æ³•å®šä¹‰

> é—®é¢˜èƒŒæ™¯ - æ— çº¦æŸæå°åŒ–é—®é¢˜ï¼š
>
> $$
> \underset{x\in \mathbb{R}^n}{\min}f(x)
> $$
> å…¶ä¸­$f\in â€¦â€¦$ã€‚

ğŸŒŸ**æœç´¢æ–¹å‘**ï¼š
$$
\boldsymbol{d}_k=-\nabla f(\boldsymbol{x_k})
$$
æœç´¢æ–¹å‘å®šä¹‰ä¸º **è´Ÿæ¢¯åº¦**çš„æ–¹å‘ã€‚

æ•…çº¿æœç´¢è¿­ä»£å…¬å¼ä¸ºï¼š$\boldsymbol{x}_{k+1}=\boldsymbol{x}_k-\alpha_k\nabla f(\boldsymbol{x}_k)$ï¼Œ  
*å…¶ä¸­æ­¥é•¿$\alpha_k$ç”±å…¶å®ƒæ–¹æ³•ï¼ˆå„ç§å‡†åˆ™ï¼‰ç¡®å®šã€‚*

## äºŒã€æ–¹æ³•åŠ¨æœº

å¯ä»¥ä»ä¸¤ä¸ªè§†è§’ç†è§£ï¼Œä¸ºä»€ä¹ˆæ–¹å‘è¦é€‰æ‹©è´Ÿæ¢¯åº¦æ–¹å‘ï¼š

1. è¦æ‰¾åˆ°å‡½æ•°å€¼ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼ˆæå°åŒ–æ–¹å‘å¯¼æ•°ï¼‰

   å¯¹äºæ–¹å‘$\boldsymbol{d}$ï¼Œå…¶æ–¹å‘å¯¼æ•°ä¸º$\boldsymbol{d}^T\nabla f(\boldsymbol{x}_k)$ï¼Œå³è¦â€œæå°åŒ–æ–¹å‘å¯¼æ•°â€$\underset{\boldsymbol{d}}{\min} \boldsymbol{d}^T\nabla f(\boldsymbol{x}_k)$ã€‚  
   ä½†æ–¹å‘å¿…é¡»æœ‰ä¸€ä¸ªé™åˆ¶æ¡ä»¶ï¼Œå¦åˆ™å°±æœ‰æ— é™ä¸ªã€‚  
   æ•…**é€šå¸¸**å°†$\boldsymbol{d}$å®šä¸º**æ–¹å‘å‘é‡**ï¼Œå³**åŠ ä¸Šçº¦æŸæ¡ä»¶ï¼šå…¶äºŒèŒƒæ•°ä¸º$1$**ï¼Œ$s.t. ||\boldsymbol{d}||_2=1$ã€‚
   > æ¯”å¦‚å¯¹äº$f(\boldsymbol{x})=\frac{1}{2}(x_1^2+x_2^4)$ï¼Œå…¶æ¢¯åº¦ä¸º$\nabla=(x_1,4x_2)$ï¼Œ  
   > å‡å¦‚å½“å‰ç‚¹$\boldsymbol{x}_k=(1,1)$ï¼Œåˆ™â€œæå°åŒ–æ–¹å‘å¯¼æ•°â€é—®é¢˜ä¸º$\min d_1+4d_2$ï¼Œè¿™æ˜¯$\R^3$ä¸€ä¸ªçš„å¹³é¢ï¼Œæ•…å¦‚æœ$\boldsymbol{d}$æ²¡æœ‰çº¦æŸï¼Œåˆ™æ— è§£ã€‚

   æ­¤æ—¶ï¼Œç”± Cauchy-Schwartz ä¸ç­‰å¼ï¼ˆ**å¯¹äºäºŒèŒƒæ•°**ï¼Œ$||\boldsymbol{x}\cdot\boldsymbol{y}||_2\ge-||\boldsymbol{x}||_2\cdot||\boldsymbol{y}||_2$ï¼Œä»…å½“$\boldsymbol{x}$ä¸$\boldsymbol{y}$æ–¹å‘ç›¸åå–ç­‰ï¼‰ï¼Œ  
   å¯çŸ¥â€œæå°åŒ–æ–¹å‘å¯¼æ•°â€é—®é¢˜çš„æœ€ä¼˜è§£ä¸º$\boldsymbol{d}$ä¸º$-\nabla$æ–¹å‘çš„å•ä½å‘é‡ã€‚

   âš ï¸**æ³¨æ„**ï¼š  
   ä»…å½“$\boldsymbol{d}$**é™å®šä¸ºå•ä½å‘é‡**ï¼ˆå³äºŒèŒƒæ•°å–$1$ï¼‰ï¼Œæ‰å¯ä»¥ç›´æ¥è¯´æ˜$\boldsymbol{d}$**å–è´Ÿæ¢¯åº¦æ–¹å‘**ï¼Œå› ä¸º CS ä¸ç­‰å¼åªå¯¹äºŒèŒƒæ•°æˆç«‹ï¼›  
   å¦åˆ™$\boldsymbol{d}$å¯èƒ½å–åˆ«çš„æ–¹å‘ã€‚
   > æ¯”å¦‚é™å®šä¸º1èŒƒæ•°ï¼Œå³$s.t. |x_1|+|x_2|=1$ï¼Œæ­¤æ—¶æœ€ä¼˜è§£ä¸2èŒƒæ•°ä¸åŒï¼Œå¯è§ä¸‹å›¾ã€‚  
   > ![ä¸æ˜¯2èŒƒæ•°](images/image-4.png)  
   > 2èŒƒæ•°çš„äº¤ç‚¹ä¸ºé»„è‰²ï¼Œ1èŒƒæ•°çš„äº¤ç‚¹ä¸ºç²‰è‰²ã€‚

2. æ–°çš„è¿­ä»£ç‚¹å¯ä»¥çœ‹æˆ$f$åœ¨$\boldsymbol{x}_k$å¤„çš„ä¸€ä¸ªäºŒé˜¶è¿‘ä¼¼ï¼ˆæå°åŒ–$f$åœ¨$\boldsymbol{x}_k$å¤„çš„äºŒé˜¶è¿‘ä¼¼ï¼‰

   åˆ©ç”¨ä¹‹å‰[Ep.3 ä¸­çš„ ä¸‰ã€2é‡è¦æ€æƒ³ - å¤šå…ƒå‡½æ•°çš„å±€éƒ¨äºŒæ¬¡è¿‘ä¼¼å‡½æ•°](../Ep.3%20æœ€ä¼˜è§£å’Œç®—æ³•çš„åŸºæœ¬æ€§è´¨/3.md#2-é‡è¦æ€æƒ³---å¤šå…ƒå‡½æ•°çš„å±€éƒ¨äºŒæ¬¡è¿‘ä¼¼å‡½æ•°)ï¼Œ  
   è®©$\boldsymbol{g}_k=\nabla f(\boldsymbol{x}_k)$ã€$B_k\approx\nabla^2 f(\boldsymbol{x}_k)=\frac{1}{\alpha_k}I$ï¼ˆè¿™é‡Œä¸ºä»€ä¹ˆ$B_k\approx\frac{1}{\alpha_k}I$ï¼Œæ˜¯å› ä¸ºä¹‹åæ±‚è§£è¿™ä¸ªé—®é¢˜èƒ½åˆšå¥½æ¨å‡º GD çš„è¿­ä»£å…¬å¼ï¼Œæ˜¯è¿­ä»£å…¬å¼å†³å®šäº†è¿™é‡Œæ˜¯è¿™ä¸ªè¿‘ä¼¼å€¼ã€å¹¶æ— å…¶ä»–æ·±å±‚åŸå› ï¼‰ï¼Œ  
   åˆ™æ–°çš„è¿­ä»£ç‚¹ä¸º$\boldsymbol{x}_{k+1}=\underset{\boldsymbol{x}}{\argmin} f(\boldsymbol{x}_k)+\nabla f(\boldsymbol{x})^T(\boldsymbol{x}-\boldsymbol{x}_k)+\frac{1}{2\alpha_k}||\boldsymbol{x}-\boldsymbol{x}_k||_2^2$

   è®°æ–¹ç¨‹$q(\boldsymbol{x})=\frac{1}{2\alpha_k}||\boldsymbol{x}-\boldsymbol{x}_k||_2^2+\nabla f(\boldsymbol{x})^T(\boldsymbol{x}-\boldsymbol{x}_k)+f(\boldsymbol{x}_k)$ï¼Œæ˜æ˜¾ä¸ºä¸€ä¸ªäºŒæ¬¡å‡½æ•°ã€‚  
   åˆ™$\nabla q=\frac{1}{\alpha_k}(\boldsymbol{x}-\boldsymbol{x}_k)+\nabla f(\boldsymbol{x})$ï¼Œ  
   $\nabla^2 q=\frac{1}{\alpha_k}\succ0$ï¼ˆ$\alpha_k>0$ï¼‰ï¼Œæ•…$q(\boldsymbol{x})$ä¸ºä¸¥æ ¼å‡¸å‡½æ•°ï¼ˆè§[Ep2.2 çš„ ä¸€äº›å‡¸å‡½æ•°çš„å¿«æ·åˆ¤æ–­](../Ep.2%20å‡¸æ€§/2.2.%20å‡¸å‡½æ•°ã€å‡¸ä¼˜åŒ–.md#ex-ä¸€äº›å‡¸å‡½æ•°çš„å¿«æ·åˆ¤æ–­)ï¼‰ï¼Œåªæœ‰ä¸€ä¸ªæå€¼ç‚¹ï¼Œä¸ºé©»ç‚¹ï¼Œ  
   åˆ™æ±‚è§£$\nabla q=0$ï¼Œå¾—åˆ°$\boldsymbol{x}_{k+1}=\boldsymbol{x}_k-\alpha_k\nabla f(\boldsymbol{x}_k)$ï¼Œå³è¿­ä»£å…¬å¼ã€‚

## ä¸‰ã€ç›¸å…³æ€§è´¨

### 1. å…¨å±€æ”¶æ•›

> å…¨å±€æ”¶æ•›æ€§è´¨æŒ‡ï¼š**å¯¹åˆå§‹å€¼è¦æ±‚ä¸é«˜**ï¼ˆå¯ä»¥æ˜¯ä»»æ„ä½ç½®ï¼‰ã€‚

å¦‚æœ GD æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

1. åˆå§‹ç‚¹$\boldsymbol{x}_0$ï¼Œå…¶ä¸‹æ°´å¹³é›†$S=\{\boldsymbol{x}:f(\boldsymbol{x})=f(\boldsymbol{x}_0)\}$æ˜¯ç´§çš„ï¼ˆæœ‰ç•Œé—­é›†ï¼‰
2. $f$åœ¨åŒ…å«$S$çš„æŸå¼€é›†ä¸Šè¿ç»­å¯å¾®
3. æ­¥é•¿$\alpha$æ»¡è¶³ Armijo æ³•åˆ™

åˆ™è¯¥ GD å…·æœ‰å…¨å±€æ”¶æ•›æ€§ï¼Œå³å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š

* ä¸‹é™æ€§ï¼šé™¤éå¾—åˆ°é©»ç‚¹ï¼Œå¦åˆ™$f(\boldsymbol{x}_i)$ä¸¥æ ¼å•è°ƒé€’å‡
* æœ‰ç•Œæ€§ï¼šè¿­ä»£è½¨è¿¹ä¸ç¦»å¼€$S$ï¼ˆæ‰€æœ‰è¿­ä»£ç‚¹éƒ½åœ¨$S$é‡Œï¼‰
* èšé›†æ€§ï¼šè½¨è¿¹ä¸€å®šæœ‰èšç‚¹ï¼Œå¹¶ä¸”æ¯ä¸ªèšç‚¹éƒ½æ˜¯$f$çš„é©»ç‚¹

> è¯æ˜ï¼š
>
> æ–¹å‘$\boldsymbol{d}_k=-\nabla f(\boldsymbol{x}_k)$
>
> å› ä¸ºæ»¡è¶³ Armijo æ³•åˆ™ï¼Œå³$f(\boldsymbol{x}_k+\alpha\boldsymbol{d}_k)<f(\boldsymbol{x})+\rho\nabla f(\boldsymbol{x}_k)^T\boldsymbol{d}_k\alpha$  
> $\Rightarrow f(\boldsymbol{x}_{k+1})<f(\boldsymbol{x})-\rho\alpha||\nabla f(\boldsymbol{x}_k)||^2_2$ï¼Œ  
> å½“æ¢¯åº¦é0æ—¶ï¼Œ$\because \rho,\alpha,||...||^2_2>0$ï¼Œæ•…$f(\boldsymbol{x}_{k+1})<f(\boldsymbol{x})$ï¼Œè¯å¾—æ€§è´¨(1)ï¼ŒåŒæ—¶ä¹Ÿå¯è¯´æ˜æ€§è´¨(2)ã€‚  
> $\because$åºåˆ—ç‚¹éƒ½åœ¨$S$é‡Œï¼Œ$S$æœ‰ç•Œï¼Œæ— é™æœ‰ç•Œåºåˆ—ä¸€å®šæœ‰èšç‚¹ï¼Œ$\therefore$è¯å¾—æ€§è´¨(3)ã€‚

å› ä¸ºæ‰¾åˆ°çš„æ˜¯é©»ç‚¹ï¼Œæ‰€ä»¥ï¼š

* å¯¹äºå‡¸å‡½æ•°ï¼Œåˆ™å¯¹åº”**å…¨å±€**æå°ç‚¹ã€‚
* å¯¹äºéå‡¸å‡½æ•°ï¼Œåˆ™å¯èƒ½æ˜¯**å±€éƒ¨**æå°ç‚¹ã€ä¹Ÿå¯èƒ½æ˜¯**éç‚¹**ã€‚

### 2. å¤æ‚æ€§åˆ†æï¼ˆæ”¶æ•›é€Ÿç‡ï¼‰

> å®šä¹‰ - Lipschitz è¿ç»­æ€§ï¼š
>
> æŒ‡æ¢¯åº¦çš„æ”¹å˜é‡å¯ä»¥è¢«è‡ªå˜é‡çš„æ”¹å˜é‡çš„çº¿æ€§å‡½æ•°æ§åˆ¶ã€‚
>
> $$
> ||\nabla f(x) - \nabla f(y)|| \le L||x-y||
> $$
>
> å…¶ä¸­$L$æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚
>
> æ˜¯ä¸€ç§æ¯”ä¸€è‡´è¿ç»­è¿˜å¼ºçš„è¿ç»­æ€§è´¨ã€‚
>
> å½“$\nabla f$æ—¶ Lipschitz çš„ï¼Œä¹Ÿå¯è¡¨ç¤ºæˆ $f$ æ˜¯ $L-\text{å…‰æ»‘}$ çš„ã€‚
>
> **åˆ¤å®šæ–¹æ³•**ï¼š  
> $\nabla^2 f(x)$çš„è°±èŒƒæ•°ä¸è¶…è¿‡$L$

1. æ¢¯åº¦æ˜¯ Lipschitz è¿ç»­çš„å‡½æ•°ï¼ˆå¯èƒ½éå‡¸ï¼‰
   * å……åˆ†ä¸‹é™æ€§ï¼š
     * æ­¥é•¿$0<\alpha<\frac{2}{L}$ -> GD è¿­ä»£æ˜¯ä¸‹é™çš„($f(x_{k+1})-f(x_k)<0$)
     * æ­¥é•¿$0<\alpha<\frac{1}{L}$ -> GD è¿­ä»£æ»¡è¶³$f(x_{k+1})-f(x_k)\le -\frac{\alpha}{2}||\nabla f(x_k)||^2$\
   * å¤æ‚æ€§$O(\frac{1}{\sqrt{k}})$
     $$
     \underset{\min}{0\le s \le k-1}||\nabla f(x_s)|| \le \sqrt{\frac{2L}{k}(f(x_0)-f_*)}
     $$
2. æ¢¯åº¦æ˜¯ Lipschitz è¿ç»­çš„**å‡¸**å‡½æ•°  
   å¤æ‚æ€§$O(\frac{1}{k})$
   $$
   f(x_k)-f(x_*)\le\frac{L||(x_0-x_*)||^2}{2k}
   $$
3. æ¢¯åº¦æ˜¯ Lipschitz è¿ç»­çš„**å¼ºå‡¸**å‡½æ•°  
   > å®šä¹‰ - $l-\text{å¼ºå‡¸}$ï¼š  
   >
   > $$
   > f((1-\theta)x_0+\theta x_1)\le(1-\theta)f(x_0)+\theta f(x_1)-\frac{l}{2}\theta(1-\theta)||x_0-x_1||^2
   > $$
   >
   > å…¶ä¸­å‰åŠéƒ¨åˆ†æœ¬æ¥å°±æ˜¯å‡¸å‡½æ•°çš„å®šä¹‰ã€‚
   >
   > å³ï¼š$f-\frac{l}{2}||x||^2$è¿˜æ˜¯å‡¸çš„
   >
   > å¦ä¸€ç§è¯æ˜ï¼š$\nabla^2 f(x) \ge lI$
   >
   > **æ€§è´¨**ï¼šå¼ºå‡¸å‡½æ•°æœ‰äºŒæ¬¡ä¸‹ç•Œã€‚

   å¤æ‚æ€§æ˜¯$O()$
   $$
   ||x_k-x_*||^2\le (1-\frac{l}{L})^k||x_0-x_*||^2
   $$
   è®°$\kappa=\frac{l}{L}$ï¼Œ$\kappa(G)$æ¡ä»¶æ•°
   $\frac{L}{l}=\frac{\lambda_{max}}{\lambda_{min}}$,$\lambda$ä¸ºç‰¹å¾å€¼

   åè€…æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—çš„é€šé¡¹ã€‚

   ä»¤$a=1-\frac{l}{L}$
   * $L=l$ -> $a=0$ -> è¿­ä»£1æ­¥åˆ™åˆ°$x_*$
   * $L>>l$ -> $\kappa\to+\infty$ -> $a\to 1$