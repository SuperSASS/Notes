# Ep.4 梯度下降法

是线搜索法格式中，确定**搜索方向**$\boldsymbol{d}_k$的一种方法。  
$\phi(\alpha)=f(\boldsymbol{x}_k+\alpha\boldsymbol{d}_k)$。

## 一、方法定义

> 问题背景 - 无约束极小化问题：
>
> $$
> \underset{x\in \mathbb{R}^n}{\min}f(x)
> $$
> 其中$f\in C^1$。

🌟**搜索方向**：
$$
\boldsymbol{d}_k=-\nabla f(\boldsymbol{x_k})
$$
搜索方向定义为 **负梯度**的方向。

故线搜索迭代公式为：$\boldsymbol{x}_{k+1}=\boldsymbol{x}_k-\alpha_k\nabla f(\boldsymbol{x}_k)$，  
*其中步长$\alpha_k$由其它方法（各种准则）确定。*

## 二、方法动机

可以从两个视角理解，为什么方向要选择负梯度方向：

1. 要找到函数值下降最快的方向（极小化方向导数）

   对于方向$\boldsymbol{d}$，其方向导数为$\boldsymbol{d}^T\nabla f(\boldsymbol{x}_k)$，即要“极小化方向导数”$\underset{\boldsymbol{d}}{\min} \boldsymbol{d}^T\nabla f(\boldsymbol{x}_k)$。  
   但方向必须有一个限制条件，否则就有无限个。  
   故**通常**将$\boldsymbol{d}$定为**方向向量**，即**加上约束条件：其二范数为$1$**，$s.t. ||\boldsymbol{d}||_2=1$。
   > 比如对于$f(\boldsymbol{x})=\frac{1}{2}(x_1^2+x_2^4)$，其梯度为$\nabla=(x_1,4x_2)$，  
   > 假如当前点$\boldsymbol{x}_k=(1,1)$，则“极小化方向导数”问题为$\min d_1+4d_2$，这是$\R^3$一个的平面，故如果$\boldsymbol{d}$没有约束，则无解。

   此时，由 Cauchy-Schwartz 不等式（**对于二范数**，$||\boldsymbol{x}\cdot\boldsymbol{y}||_2\ge-||\boldsymbol{x}||_2\cdot||\boldsymbol{y}||_2$，仅当$\boldsymbol{x}$与$\boldsymbol{y}$方向相反取等），  
   可知“极小化方向导数”问题的最优解为$\boldsymbol{d}$为$-\nabla$方向的单位向量。

   ⚠️**注意**：  
   仅当$\boldsymbol{d}$**限定为单位向量**（即二范数取$1$），才可以直接说明$\boldsymbol{d}$**取负梯度方向**，因为 CS 不等式只对二范数成立；  
   否则$\boldsymbol{d}$可能取别的方向。
   > 比如限定为1范数，即$s.t. |x_1|+|x_2|=1$，此时最优解与2范数不同，可见下图。  
   > ![不是2范数](images/image-4.png)  
   > 2范数的交点为黄色，1范数的交点为粉色。

2. 新的迭代点可以看成$f$在$\boldsymbol{x}_k$处的一个二阶近似（极小化$f$在$\boldsymbol{x}_k$处的二阶近似）

   利用之前[Ep.3 中的 三、2重要思想 - 多元函数的局部二次近似函数](../Ep.3%20最优解和算法的基本性质/3.md#2-重要思想---多元函数的局部二次近似函数)，  
   则新的迭代点为$$

## 性质

### 1. 全局收敛

指对初始值要求不高

### 2. 复杂性（收敛速率）

> 定义 - Lipschitz 连续性：
>
> 指梯度的改变量可以被自变量的改变量的线性函数控制。
>
> $$
> ||\nabla f(x) - \nabla f(y)|| \le L||x-y||
> $$
>
> 其中$L$是一个常数。
>
> 是一种比一致连续还强的连续性质。
>
> 当$\nabla f$时 Lipschitz 的，也可表示成 $f$ 是 $L-\text{光滑}$ 的。
>
> **判定方法**：  
> $\nabla^2 f(x)$的谱范数不超过$L$

1. 梯度是 Lipschitz 连续的函数（可能非凸）
   * 充分下降性：
     * 步长$0<\alpha<\frac{2}{L}$ -> GD 迭代是下降的($f(x_{k+1})-f(x_k)<0$)
     * 步长$0<\alpha<\frac{1}{L}$ -> GD 迭代满足$f(x_{k+1})-f(x_k)\le -\frac{\alpha}{2}||\nabla f(x_k)||^2$\
   * 复杂性$O(\frac{1}{\sqrt{k}})$
     $$
     \underset{\min}{0\le s \le k-1}||\nabla f(x_s)|| \le \sqrt{\frac{2L}{k}(f(x_0)-f_*)}
     $$
2. 梯度是 Lipschitz 连续的**凸**函数  
   复杂性$O(\frac{1}{k})$
   $$
   f(x_k)-f(x_*)\le\frac{L||(x_0-x_*)||^2}{2k}
   $$
3. 梯度是 Lipschitz 连续的**强凸**函数  
   > 定义 - $l-\text{强凸}$：  
   >
   > $$
   > f((1-\theta)x_0+\theta x_1)\le(1-\theta)f(x_0)+\theta f(x_1)-\frac{l}{2}\theta(1-\theta)||x_0-x_1||^2
   > $$
   >
   > 其中前半部分本来就是凸函数的定义。
   >
   > 即：$f-\frac{l}{2}||x||^2$还是凸的
   >
   > 另一种证明：$\nabla^2 f(x) \ge lI$
   >
   > **性质**：强凸函数有二次下界。

   复杂性是$O()$
   $$
   ||x_k-x_*||^2\le (1-\frac{l}{L})^k||x_0-x_*||^2
   $$
   记$\kappa=\frac{l}{L}$，$\kappa(G)$条件数
   $\frac{L}{l}=\frac{\lambda_{max}}{\lambda_{min}}$,$\lambda$为特征值

   后者是一个等比数列的通项。

   令$a=1-\frac{l}{L}$
   * $L=l$ -> $a=0$ -> 迭代1步则到$x_*$
   * $L>>l$ -> $\kappa\to+\infty$ -> $a\to 1$