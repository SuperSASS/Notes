# Ep.7.2 æ¬¡æ¢¯åº¦æ³•(SG)

**æ€»ç»“**ï¼š

* é€‚ç”¨ï¼šæ— çº¦æŸã€å‡¸ä¼˜åŒ–
* è¿­ä»£å…¬å¼å®šä¹‰ï¼š$\boldsymbol{x}_{k+1}=\boldsymbol{x}_k-\alpha_k\boldsymbol{g}_k$  
  å…¶ä¸­ï¼š$f$æ˜¯å‡¸å‡½æ•°ä½†ä¸å¯å¾®ï¼Œ$\boldsymbol{g}_k$æ˜¯$\boldsymbol{x}_k$å¤„çš„ä¸€ä¸ªæ¬¡æ¢¯åº¦ï¼Œå³$\boldsymbol{g}_k\in\partial f(\boldsymbol{x}_k)$ã€‚
* ä¸€äº›æ€§è´¨æ€»ç»“
  * SG ä¸Ž GD ä¸åŒï¼šè´Ÿæ¬¡æ¢¯åº¦æ–¹å‘**ä¸ä¸€å®šæ˜¯ä¸‹é™æ–¹å‘**ï¼ˆå¯èƒ½ä¸å˜ç”šè‡³ä¸Šå‡ï¼‰
  * ä¸å¯å¾®$f$çš„$G-$Lipschitzè¿žç»­æ€§ï¼š$\|\boldsymbol{g}\|\leq G\quad\forall x,\forall \boldsymbol{g}\in\partial f(x)$  
    å¯¹äºŽä»»æ„ç‚¹ï¼Œå…¶æ¬¡å¾®åˆ†çš„**ç»å¯¹å€¼**æœ‰ä¸Šç•Œ$G$ã€‚
* æ­¥é•¿é€‰æ‹©  
  å¦‚æžœæ€»è¿­ä»£æ¬¡æ•°å®šä¸º$k$ã€‚
  * å›ºå®šæ­¥é•¿ï¼š$\alpha\sim\frac{1}{\sqrt{k}}$ï¼Œ  
    å¦‚æžœ$f$æ˜¯$G-$Lipschitzè¿žç»­çš„ï¼Œåˆå§‹ç‚¹ä¸Žæžå°ç‚¹çš„è·ç¦»ä¸Šç•Œä¸º$R$ï¼ˆ$\|\boldsymbol{x}_1-\boldsymbol{x}_*\|\le R$ï¼‰ï¼Œ  
    åˆ™ä¸€èˆ¬å–ä¸º$\frac{R}{G\sqrt{k}}$ã€‚
  * **è¡°å‡æ­¥é•¿**ï¼š*æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶*ï¼Œä½†ä¸€èˆ¬åªè€ƒè™‘å–ä¸¤ç§å…¸åž‹å€¼ï¼š
    * $\alpha_i=\frac{M}{i}$
    * ðŸŒŸ$\alpha_i=\frac{M}{\sqrt{i}}$  
      å¦‚æžœ$f$æ˜¯$G-$Lipschitzè¿žç»­çš„ï¼Œ$k$ä¸ºå¶æ•°ï¼Œä¸­é—´çš„è¿­ä»£ç‚¹ä¸Žæžå°ç‚¹çš„è·ç¦»ä¸Šç•Œä¸º$R$ï¼ˆ$\|\boldsymbol{x}_{k/2}-\boldsymbol{x}_*\|\le R$ï¼‰ï¼Œ  
      åˆ™ä¸€èˆ¬å–ä¸º$\frac{R}{G\sqrt{i}}$ã€‚
  * *å›ºå®šå¢žé‡æ­¥é•¿*ï¼ˆä¸æ€Žä¹ˆç”¨ï¼‰ï¼š$\alpha_k\|\boldsymbol{g}_k\|_2=\|\boldsymbol{x}_{k+1}-\boldsymbol{x}_k\|=s$  
    è®©æ¯æ¬¡è¿­ä»£çš„å‡½æ•°å€¼æ”¹å˜é‡ï¼ˆå¢žé‡ï¼‰ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šçš„å¤§å°$s$ï¼Œä»Žè€ŒæŽ¨ç®—å‡ºç›¸åº”çš„$\alpha_k$  
* æ–¹æ³•è¾“å‡ºæ–¹å¼
  * å½“å‰æœ€å¥½ç‚¹ï¼š$\boldsymbol{x}_k^{best}$
  * è¿­ä»£ç‚¹åŠ æƒå¹³å‡ï¼š$\sum_{i=k_0}^{k}\frac{\alpha_i}{\sum_{s=k_0}^k\alpha_s}\boldsymbol{x}_i$
  * å½“å‰è¿­ä»£ç‚¹:$\boldsymbol{x}_k$ï¼ˆè¿™ä¸ªæ— æ³•è¿›è¡Œå¤æ‚åº¦ç†è®ºåˆ†æžï¼Œä½†å®žé™…è¿ç”¨æ•ˆæžœä¹Ÿå¯ä»¥ï¼‰
* å¤æ‚åº¦  
  è¦æ±‚ï¼š$f$æ˜¯$G-$Lipschitzè¿žç»­çš„ã€‚
  * å›ºå®šæ­¥é•¿ï¼š$\alpha=\frac{R}{G\sqrt{k}}$ï¼Œå…¶ä¸­$R$ä¸ºåˆå§‹ç‚¹ä¸Žæžå°ç‚¹çš„è·ç¦»ä¸Šç•Œ  
    å‰ä¸¤ç§è¾“å‡ºå‡æ»¡è¶³ï¼š$f(\boldsymbol{x}_k^{best})-f(\boldsymbol{x}_*)\le\frac{GR}{\sqrt{k}}$ï¼ˆ$\boldsymbol{x}_k^{best}$å¯æ¢æˆ$\bar{\boldsymbol{x}}$ï¼‰
  * *è¡°å‡æ­¥é•¿*ï¼ˆæ²¡ç”¨ï¼Œçœ‹åŽé¢ä¸€ä¸ªï¼‰ï¼šæ­¥é•¿æ»¡è¶³è¡°å‡æ­¥é•¿è¦æ±‚  
    $\lim_{k\to+\infty}f(\boldsymbol{x}_k^{best})=\lim_{k\to+\infty}f(\bar{\boldsymbol{x}})=f(\boldsymbol{x}_*)$  
    å‰ä¸¤ç§è¾“å‡ºçš„å‡½æ•°å€¼å‡è¶‹è¿‘äºŽæœ€ä¼˜å€¼
  * ç»å…¸çš„è¡°å‡æ­¥é•¿ï¼š$\alpha_i=\frac{R}{G\sqrt{i}}$ï¼Œå…¶ä¸­$k$ä¸ºå¶æ•°ï¼Œ$R$ä¸º**ä¸­é—´çš„è¿­ä»£ç‚¹**ä¸Žæžå°ç‚¹çš„è·ç¦»ä¸Šç•Œï¼ˆè§ä¸Šæ­¥é•¿é€‰æ‹©ï¼‰  
    æ»¡è¶³ï¼š$f(\boldsymbol{x}_k^{best})-f(\boldsymbol{x}_*)\le\frac{2GR}{\sqrt{k}}$ï¼ˆ$\boldsymbol{x}_k^{best}$å¯æ¢æˆ$\tilde{\boldsymbol{x}}$ï¼Œä»£è¡¨åŽä¸€åŠçš„åŠ æƒå¹³å‡ï¼‰

## ä¸€ã€æ–¹æ³•å®šä¹‰

> é—®é¢˜å®šä¹‰ï¼š
>
> $$
> \min_{x\in\R^n} f(x)
> $$
>
> å…¶ä¸­ï¼š$f$æ˜¯å‡¸å‡½æ•°ï¼Œä½†**ä¸å¯å¾®**ï¼ˆå¯èƒ½éƒ¨åˆ†å¯å¾®ï¼Œä½†ä¸€å®šå­˜åœ¨ä¸å¯å¾®ç‚¹ï¼‰ã€‚

æ¬¡æ¢¯åº¦æ³•çš„è¿­ä»£å…¬å¼ï¼š

$$
\boldsymbol{x}_{k+1}=\boldsymbol{x}_k-\alpha_k\boldsymbol{g}_k
$$

å…¶ä¸­ï¼š$\boldsymbol{g}_k$æ˜¯$\boldsymbol{x}_k$å¤„çš„ä¸€ä¸ªæ¬¡æ¢¯åº¦ï¼Œå³$\boldsymbol{g}_k\in\partial f(\boldsymbol{x}_k)$ã€‚

*å°±æ˜¯ GDï¼Œåªä¸è¿‡æ— æ³•æ±‚æ¢¯åº¦ï¼Œæ•…ç”¨ä¸€ä¸ªæ¬¡æ¢¯åº¦ã€‚*

**ä¸Ž GD æœ‰ä¸ªæœ€å¤§ä¸åŒæ˜¯**ï¼š

* GD ä¸­ï¼šè´Ÿæ¢¯åº¦æ–¹å‘ï¼Œä¸€å®šæ˜¯ä¸‹é™æ–¹å‘ï¼ˆæ²¿è´Ÿæ¢¯åº¦èµ°ä¸€ç‚¹å‡½æ•°å€¼å‡å°ï¼‰ï¼Œå¹¶ä¸”æ˜¯å½“å‰ç‚¹ä¸‹é™æœ€å¿«çš„æ–¹å‘
* SG ä¸­ï¼šè´Ÿæ¬¡æ¢¯åº¦æ–¹å‘ï¼Œ**ä¸ä¸€å®šæ˜¯ä¸‹é™æ–¹å‘**ï¼Œå¯èƒ½å‡½æ•°å€¼ä¸å˜ã€**ç”šè‡³å¯èƒ½æ˜¯ä¸Šå‡æ–¹å‘**  
  > ä¸¾ä¾‹ - è´Ÿæ¬¡æ¢¯åº¦æ–¹å‘å¹¶ä¸æ˜¯ä¸‹é™æ–¹å‘ï¼š
  >
  > $f(\boldsymbol{x})=|x_1|+2|x_2|$  
  > ![å‡½æ•°å›¾](images/image-7.2.æ¬¡æ¢¯åº¦æ³•.png)
  >
  > åœ¨$\boldsymbol{x}_1=(1,0)$å¤„ï¼Œ$\partial f(\boldsymbol{x}_1)=\{(1,a):a\in[-2,2]\}$ï¼š
  >
  > * å¯¹äºŽ$\boldsymbol{g}=(1,2)$ï¼Œå…¶ç›¸åæ–¹å‘ä¸æ˜¯ä¸‹é™æ–¹å‘ï¼ˆæŒ‡å‘å¤–éƒ¨ï¼Œå‡½æ•°å€¼ä¸Šå‡ï¼‰
  > * å¯¹äºŽ$\boldsymbol{g}=(1,0.5)$ï¼Œå…¶ç›¸åæ–¹å‘ä¸æ˜¯ä¸‹é™æ–¹å‘ï¼ˆæ²¿ç€ç­‰é«˜çº¿èµ°ã€å‡½æ•°å€¼ä¸å˜ï¼‰
  > * å¯¹äºŽ$\boldsymbol{g}=(1,0)$ï¼Œå…¶ç›¸åæ–¹å‘æ˜¯ä¸‹é™æ–¹å‘ï¼ˆå¹¶ä¸”è¿˜æ˜¯æœ€é€Ÿä¸‹é™æ–¹å‘ï¼Œå› ä¸ºå…¶äºŒèŒƒæ•°æœ€å°ï¼‰

## äºŒã€æ­¥é•¿è§„åˆ™

æœ‰ä»¥ä¸‹ä¸‰ç§ç¡®å®šæ­¥é•¿çš„è§„åˆ™ã€‚

### 1. å›ºå®šæ­¥é•¿

å¦‚æžœå‡†å¤‡è¿›è¡Œ$k$æ¬¡è¿­ä»£ï¼ˆ$k$æ˜¯ä¸€ä¸ªå®šå€¼ï¼‰ï¼Œå…¶æ‰€æœ‰çš„æ­¥é•¿$\alpha$ä¸ºä¸€ä¸ªå›ºå®šå€¼ï¼š

$$
\alpha \sim \frac{1}{\sqrt{k}}
$$
æ˜¯æŒ‡$\alpha$æ˜¯ä¸Ž$\frac{1}{\sqrt{k}}$æ˜¯åŒé˜¶çš„ä¸€ä¸ªé‡ã€‚  
å³å¦‚æžœå‡†å¤‡è¿­ä»£å¾ˆå¤šæ­¥ï¼Œåˆ™æ­¥é•¿åº”è¯¥æ›´å°ã€‚

å­˜åœ¨é—®é¢˜ï¼ˆ[è§ä¸‹å¤æ‚åº¦åˆ†æž](#3-ç»å…¸çš„è¡°å‡æ­¥é•¿)ï¼‰ï¼šä¸ºäº†è®©è¯¯å·®å¾ˆå°ï¼Œ$k$è¦å¾ˆå¤§ï¼Œæ­¥é•¿å¾ˆå°ä¸”å›ºå®šï¼Œå¯¼è‡´åˆå§‹è¿­ä»£æ—¶å¾ˆç¼“æ…¢ï¼Œæ•ˆæžœä¸å¥½ã€‚

### ðŸŒŸ2. è¡°å‡æ­¥é•¿

å¯¹äºŽç¬¬$k$æ¬¡è¿­ä»£ï¼Œå…¶æ­¥é•¿$\alpha_k$è¦æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š

1. $$
   \frac{\sum_{k=1}^\infty\alpha_k^2}{\sum_{k=1}^\infty\alpha_k}\to0
   $$
   å³æ­¥é•¿æœ¬èº«æ˜¯è¶‹äºŽ$0$çš„ï¼Œå¹¶ä¸”â€œå¹³æ–¹å’Œâ€æ¯”ä¸Šâ€œæ±‚å’Œâ€è¦è¶‹äºŽ0ã€‚
2. $$
   \sum_{k=1}^\infty\alpha_k\to\infty
   $$
   ä½†æ˜¯æ•´ä¸ªæ±‚å’Œæ˜¯è¶‹äºŽæ— ç©·çš„ã€‚

**è¿™ä¸ªæ­¥é•¿æ˜¯å¾ˆå¥½çš„ä¸€ä¸ªé€‰æ‹©**ã€‚

ðŸŒŸ**ä¸€äº›å…¸åž‹çš„è¡°å‡æ­¥é•¿**ï¼š

* $\alpha_i=\frac{M}{i}$
* $\alpha_i=\frac{M}{\sqrt{i}}$

å…¶ä¸­ï¼š$M$ä¸ºä¸€ä¸ªæ­£æ•°ã€‚

### 3. å›ºå®šå¢žé‡æ­¥é•¿

å¯¹äºŽç¬¬$k$æ¬¡è¿­ä»£ï¼Œå…¶æ­¥é•¿$\alpha_k$è¦ä½¿å¾—ï¼š

$$
\alpha_k\|\boldsymbol{g}_k\|_2=\|\boldsymbol{x}_{k+1}-\boldsymbol{x}_k\|=s
$$

å³è®©æ¯æ¬¡è¿­ä»£çš„å‡½æ•°å€¼æ”¹å˜é‡ï¼ˆå¢žé‡ï¼‰ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šçš„å¤§å°$s$ï¼Œä»Žè€ŒæŽ¨ç®—å‡ºç›¸åº”çš„$\alpha_k$ã€‚

## ä¸‰ã€æ–¹æ³•è¾“å‡º

è¿­ä»£æ–¹æ³•æœ€ç»ˆéƒ½è¦è¾“å‡ºä¸€ä¸ªç‚¹$\boldsymbol{x}$ã€‚  
æ¬¡æ¢¯åº¦æ³•ä¸åƒä¹‹å‰çš„æ–¹æ³•ï¼Œç›´æŽ¥è¾“å‡ºå½“å‰è¿­ä»£ç‚¹$\boldsymbol{x}_k$çš„è¯ï¼Œæ— æ³•è¿›è¡Œå¤æ‚åº¦åˆ†æžï¼Œ  
åªèƒ½å¯¹ä»¥ä¸‹ä¸¤ç§é¢å¤–çš„è¾“å‡ºæ–¹æ³•ï¼Œè¿›è¡Œç†è®ºåˆ†æžã€‚

### 1. å½“å‰æœ€å¥½ç‚¹

$$
\boldsymbol{x}_k^{best}=\argmin_{\boldsymbol{x}\in\{\boldsymbol{x}_1,\cdots,\boldsymbol{x}_k\}} f(\boldsymbol{x})
$$

### 2. è¿­ä»£ç‚¹åŠ æƒå¹³å‡

ä¹Ÿæ˜¯å„è¿­ä»£ç‚¹ï¼ˆæ‰€æœ‰è¿­ä»£ç‚¹ã€æˆ–è€…åŽä¸€åŠè¿­ä»£ç‚¹ï¼‰çš„å‡¸ç»„åˆï¼Œå…¶å‡¸ç»„åˆç³»æ•°**å–å†³äºŽæ­¥é•¿**ï¼Œå¦‚ä¸‹ï¼š
  
$$
\bar{\boldsymbol{x}}=\sum_{i=k_0}^{k}\frac{\alpha_i}{\sum_{s=k_0}^k\alpha_s}\boldsymbol{x}_i
$$

å…¶ä¸­ï¼š$k_0$é€šå¸¸å–1æˆ–$k/2$ã€‚

> ç‰¹ä¾‹ï¼šå¦‚æžœå½“$k_0=1$ï¼Œ$\alpha_i=\alpha$ï¼ˆæ‰€æœ‰æ­¥é•¿éƒ½ä¸€æ ·ï¼‰ï¼Œåˆ™ä¸º$\bar{\boldsymbol{x}}=\frac1k\sum_{i=1}^k\boldsymbol{x}_i$

### *3. å½“å‰è¿­ä»£ç‚¹

è™½ç„¶ç›´æŽ¥è¾“å‡ºå½“å‰è¿­ä»£ç‚¹$\boldsymbol{x}_k$ï¼Œæ— æ³•è¿›è¡Œå¤æ‚åº¦çš„ç†è®ºåˆ†æžï¼Œ  
ä½†å®žé™…ä½¿ç”¨è¡¨æ˜Žï¼Œç›´æŽ¥è¾“å‡ºå½“å‰è¿­ä»£ç‚¹æ•ˆæžœä¹Ÿå¾ˆå¥½ï¼ˆå…·ä½“è§åŽé¢çš„[ç®—æ³•å®žä¾‹](#äº”ç®—æ³•å®žä¾‹---lasso-é—®é¢˜)ï¼‰ã€‚

## å››ã€å¤æ‚æ€§åˆ†æž

### 0. é¢„å¤‡çŸ¥è¯† - å‡¸ Lipschitz å‡½æ•°çš„ç­‰ä»·åˆ»ç”»

*å›žé¡¾ä¹‹å‰[å‡½æ•°$f$æ˜¯$L-$Lipschitz è¿žç»­çš„åˆ¤æ–­æ–¹æ³•](../Ep.4%20æ¢¯åº¦ä¸‹é™æ³•(GD)/4.md#1-é’ˆå¯¹å‡½æ•°çš„åˆ¤å®šæ–¹æ³•)ï¼šçœ‹å…¶å¯¼æ•°æ˜¯å¦æœ‰ä¸€ä¸ªä¸Šç•Œã€‚*

å¯¹äºŽå‡¸å‡½æ•°$f:\R^n\to(-\infty,+\infty]$ï¼š  
$f$æ˜¯$G-$Lipschitzçš„ï¼ˆå³å¯¹$\forall\boldsymbol{x},\boldsymbol{y},|f(\boldsymbol{x})-f(\boldsymbol{y})|\le G\|\boldsymbol{x}-\boldsymbol{y}\|$ï¼‰çš„å……è¦æ¡ä»¶æ˜¯ï¼š
$$
\|\boldsymbol{g}\|\leq G\quad\forall x,\forall \boldsymbol{g}\in\partial f(x)
$$  
å³å¯¹äºŽä»»æ„ç‚¹ï¼Œå…¶**æ¬¡å¾®åˆ†ï¼ˆæ‰€æœ‰æ¬¡æ¢¯åº¦ï¼‰çš„ç»å¯¹å€¼æœ‰ä¸Šç•Œ$G$**ï¼ˆæ³¨æ„æ˜¯**ç»å¯¹å€¼æœ‰ä¸Šç•Œ**ï¼Œè€Œå¯¼æ•°åˆ¤æ–­æ˜¯**æœ¬èº«æœ‰ä¸Šç•Œ**ï¼‰ã€‚

> è¯æ˜Žï¼š
>
> ![è¯æ˜Ž](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-1.png)

### 1. æ¬¡æ¢¯åº¦æ³•çš„å¤æ‚æ€§

*å¯¹äºŽ$G-$Lipschitzå‡¸å‡½æ•°ï¼Œå¯¹ä¸Šé¢ä¸‰ç§æ­¥é•¿ã€ä¸¤ç§è¾“å‡ºåˆ†æžå¤æ‚æ€§ã€‚*

$f:\R^n\to\R$ï¼Œå…¶ä¸º $G-$Lipschitz çš„å‡¸å‡½æ•°ï¼Œæžå°ç‚¹$\boldsymbol{x}_*$ï¼Œ  
åˆ™å¯¹äºŽ SG äº§ç”Ÿçš„åºåˆ—ï¼ˆå¤æ‚æ€§ï¼‰ï¼š

#### (1) å›ºå®šæ­¥é•¿

**å‰æ**ï¼š

* åˆå§‹ç‚¹ä¸Žæžå°ç‚¹çš„è·ç¦»ä¸Šç•Œä¸º$R$ï¼š$\|\boldsymbol{x}_1-\boldsymbol{x}_*\|\le R$
* æ­¥é•¿ä¸ºå›ºå®šæ­¥é•¿ï¼šå·²çŸ¥æ€»è¿­ä»£æ¬¡æ•°$k$ï¼Œ$\alpha=\frac{R}{G\sqrt{k}}$

**åˆ™**ï¼š

$$
f(\boldsymbol{x}_k^{best})-f(\boldsymbol{x}_*)\le\frac{GR}{\sqrt{k}} \\
f(\bar{\boldsymbol{x}})-f(\boldsymbol{x}_*)\le\frac{GR}{\sqrt{k}}
$$

å³ä¸¤ç§è¾“å‡ºçš„å¤æ‚æ€§å‡ä¸º$O(\frac{1}{\sqrt{k}})$ã€‚

#### (2) è¡°å‡æ­¥é•¿

**å‰æ**ï¼š

* æ­¥é•¿ä¸º[è¡°å‡æ­¥é•¿](#2-è¡°å‡æ­¥é•¿)ï¼šå³æ­¥é•¿æœ¬èº«æ˜¯è¶‹äºŽ$0$çš„ï¼Œå¹¶ä¸”å¹³æ–¹å’Œæ¯”ä¸Šæ±‚å’Œè¦è¶‹äºŽ0ï¼›ä½†æ˜¯æ•´ä¸ªæ±‚å’Œæ˜¯è¶‹äºŽæ— ç©·çš„ã€‚

**åˆ™**ï¼š

$$
\lim_{k\to+\infty}f(\boldsymbol{x}_k^{best})=\lim_{k\to+\infty}f(\bar{\boldsymbol{x}})=f(\boldsymbol{x}_*)
$$

å³ä¸¤ç§è¾“å‡ºçš„å‡½æ•°å€¼éƒ½ä¼šè¶‹äºŽæœ€å°å€¼ã€‚

#### (3) ç»å…¸çš„è¡°å‡æ­¥é•¿

> æ¥æºï¼š
>
> è™½ç„¶ç¬¬ä¸€ç§â€œå›ºå®šæ­¥é•¿â€å…¶å½¢å¼ç®€å•å¥½æ‡‚ï¼Œä½†å¦‚æžœè¦è¾¾åˆ°å¾ˆå¤§çš„ç²¾åº¦ï¼Œ$k$å°±è¦å¾ˆå¤§ï¼Œä»Žè€Œå¯¼è‡´æœ€å¼€å§‹è¿­ä»£çš„æ­¥é•¿å¾ˆå°ï¼Œè¿›å±•å¾ˆç¼“æ…¢ã€‚  
> æ•…è¿™é‡Œè®©æ­¥é•¿å–è¡°å‡æ­¥é•¿å…¸åž‹$\frac{M}{\sqrt{i}}$ï¼Œå³åˆšå¼€å§‹æ­¥é•¿å¾ˆå¤§ã€åŽé¢æ­¥é•¿å‡å°ï¼Œå¯ä»¥å¾—åˆ°ä¸Žâ€œå›ºå®šæ­¥é•¿â€ç±»ä¼¼çš„å½¢å¼ã€‚

**å‰æ**ï¼š

* æ€»è¿­ä»£æ¬¡æ•°$k$ä¸ºå¶æ•°
* ä¸­é—´çš„è¿­ä»£ç‚¹ä¸Žæžå°ç‚¹çš„è·ç¦»ä¸Šç•Œä¸º$R$ï¼š$\|\boldsymbol{x}_{k/2}-\boldsymbol{x}_*\|\le R$
* æ­¥é•¿ä¸ºè¡°å‡æ­¥é•¿çš„ç»å…¸å½¢å¼$\frac{M}{\sqrt{i}}$ï¼ˆå–$M=\frac{R}{G}ï¼‰$ï¼š
  $$
  \forall i,\quad \alpha_i=\frac{R}{G\sqrt{i}}
  $$

**åˆ™**ï¼š

$$
f(\boldsymbol{x}_k^{best})-f(\boldsymbol{x}_*)\le\frac{2GR}{\sqrt{k}} \\
f(\tilde{\boldsymbol{x}})-f(\boldsymbol{x}_*)\le\frac{2GR}{\sqrt{k}}
$$
å…¶ä¸­ï¼š$\tilde{\boldsymbol{x}}$ä¸º**åŽä¸€åŠçš„è¿­ä»£ç‚¹åŠ æƒå¹³å‡**ï¼Œ$\tilde{\boldsymbol{x}}=\sum_{i=k/2}^{k}\frac{\alpha_i}{\sum_{s=k/2}^k\alpha_s}\boldsymbol{x}_i=\frac{\sum\frac{1}{\sqrt{i}}\boldsymbol{x}_i}{\sum \frac{1}{\sqrt{s}}}$ã€‚

> è¯æ˜Ž - ä¸‰ä¸ªå¤æ‚æ€§ï¼š
>
> æ€è·¯ï¼šè€ƒè™‘è¿­ä»£åˆ°æœ€ä¼˜è§£çš„è·ç¦»$\|\boldsymbol{x}_i-\boldsymbol{x}_*\|$ã€‚
>
> ![1](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-2.png)  
> ![2](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-3.png)
>
> * è¡°å‡æ­¥é•¿ï¼š  
>   å› ä¸ºè¡°å‡æ­¥é•¿çš„å®šä¹‰ï¼š$\sum\alpha\to+\infty$ä»£å…¥ä¸ç­‰å¼å³ä¾§ç¬¬ä¸€é¡¹ï¼Œ$\frac{\sum\alpha^2}{\sum\alpha}\to0$ä»£å…¥ç¬¬äºŒé¡¹ï¼Œ  
>   æ•…ç”±â‘ è¯å¾—$f(\boldsymbol{x}_k^{best})\to f(\boldsymbol{x}_*)$ï¼Œç”±â‘¡è¯å¾—$f(\bar{x})\to f(\boldsymbol{x}_*)$ã€‚
> * å›ºå®šæ­¥é•¿ï¼š  
>   å³$\sum\alpha_i = k\alpha$ï¼Œä»£å…¥å³ä¾§ä¸º$\frac{R^2}{2k\alpha}+\frac{G^2\alpha}{2}$ï¼Œ  
>   é€‰ä¸€ä¸ª$\alpha$è®©å…¶æœ€å°ï¼ˆåŠ å·ä¸¤ä¾§ç›¸ç­‰ï¼‰ï¼Œå³é€‰$\alpha=\frac{R}{G\sqrt{k}}$ï¼Œä»£å…¥å¾—å³ä¾§ä¸º$\frac{GR}{\sqrt{k}}$
>
> å¯¹äºŽç¬¬ä¸‰ä¸ªâ€œç»å…¸çš„è¡°å‡æ­¥é•¿â€ï¼Œéœ€è¦å›žå¤´å¦å¤–å¤„ç†ï¼š
>
> ![3.1](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-4.png)  
> ![3.2](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-5.png)

## äº”ã€ç®—æ³•å®žä¾‹ - LASSO é—®é¢˜

ç”¨æ±‚è§£ LASSO é—®é¢˜ï¼Œæ¥è¡¨çŽ°ç®—æ³•ä¸­ä¸åŒæ­¥é•¿é€‰æ‹©çš„å¤æ‚æ€§ã€ä¸åŒè¾“å‡ºçš„æ•ˆæžœã€‚

> é—®é¢˜èƒŒæ™¯ï¼š
>
> ç”¨ SG æ±‚è§£ LASSO é—®é¢˜ï¼š
> $$
> \boldsymbol{x}_*\in\argmin_{\boldsymbol{x}\in\R^n} f(\boldsymbol{x})=\frac{1}{2}\|\boldsymbol{b}-A\boldsymbol{x}\|> ^2_2+\tau\|\boldsymbol{x}\|_1
> $$
> å…¶ä¸­ï¼š$A\in\R^{512\times1024}$ï¼Œ$b\in\R^{512}$ï¼Œ$\tau=1$ã€‚

é€‰ç”¨çš„ï¼ˆæ¬¡å¾®åˆ†ä¸­çš„ï¼‰æ¬¡æ¢¯åº¦ä¸ºï¼š
$$
\boldsymbol{g}_k=A^T(A\boldsymbol{x}_k-b)+\text{sign}_0(\boldsymbol{x}_k)
$$
å…¶ä¸­ï¼š$\text{sign}_0$ä¸ºâ€œ[ä¿®æ­£ç¬¦å·å‡½æ•°](7.1.æ¬¡æ¢¯åº¦)â€çš„ç‰¹ä¾‹ï¼Œ$x_i=0$æ—¶å°±å–$0$ï¼Œå³$\text{sign}(x_i)=\begin{cases}1&x_i>0\\ 0&x_i=0\\-1&x_i<0\end{cases}$ã€‚ï¼ˆä½†ä¹Ÿå¯ä»¥å–$[-1,1]$çš„ä»»æ„æ•°ï¼‰ã€‚

**å¯¹ä¸åŒçš„è¾“å‡ºï¼Œæ•ˆæžœå¦‚ä¸‹**ï¼š

* ç›´æŽ¥è¾“å‡ºå½“å‰è¿­ä»£ç‚¹  
  ![1](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-6.png)  
  å¯ä»¥çœ‹åˆ°ï¼š
  * è™½ç„¶ç›´æŽ¥è¾“å‡ºå½“å‰è¿­ä»£ç‚¹æ— æ³•ç†è®ºåˆ†æžå¤æ‚åº¦ï¼Œä½†å¯ä»¥çœ‹åˆ°æ•ˆæžœä¹Ÿæ˜¯å¾ˆå¥½çš„
  * è¡°å‡æ­¥é•¿ï¼Œåˆšå¼€å§‹æ•ˆæžœä¸å¥½ï¼ˆç”šè‡³è¯¯å·®å¢žåŠ ï¼‰ï¼Œä½†æœ€åŽèƒ½åˆ°å¾ˆé«˜çš„ç²¾åº¦
* è¿­ä»£ç‚¹åŠ æƒå¹³å‡  
  ![2](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-8.png)  
  å¯ä»¥çœ‹åˆ°æ•ˆæžœæ¯”è¾ƒå·®
* å½“å‰æœ€å¥½ç‚¹  
  ![3](images/image-7.2.æ¬¡æ¢¯åº¦æ³•-7.png)  
  å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ˜¯æœ€å¥½çš„æ–¹æ³•ï¼Œä½†è¿™ä¸ªæ–¹æ³•éœ€è¦æ¯æ¬¡è®¡ç®—è¿›è¡Œæ¯”è¾ƒä»¥è®°å½•æœ€å¥½ç‚¹ï¼Œå¹¶ä¸”è¿˜éœ€è¦æ¯æ¬¡éƒ½è®¡ç®—å‡ºè¿­ä»£ç‚¹ã€è™½ç„¶ä¸æ‡‚è¿™ä¸ªä»€ä¹ˆæ„æ€â€¦â€¦