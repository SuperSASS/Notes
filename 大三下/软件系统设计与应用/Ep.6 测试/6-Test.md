# Ep.6 测试

两种思维模式：

* 正向思维 - 验证软件正常工作
* 逆向思维 - 假定软件有错误   
  为了发现错误而针对某个程序或系统的执行过程

---

## 测试分类

* 白盒测试：根据模块内部结构，基于程序内部逻辑结构，针对程序语句、路径、变量状态等进行测试
  * 静态：直接看代码是否存在逻辑问题
  * 动态：通过程序运行方式看是否存在问题，需要给定输入、预期书粗话

## 单元测试

主要采用白盒测试，辅以黑盒测试。  
白盒测试应用于代码评审、单元程序之中，而黑盒测试方法则应用于模块、组件等大单元的功能测试中。

### 1. 静态白盒测试方法

#### (1) 逻辑覆盖法

通过对**程序逻辑结构的遍历**实现对程序的覆盖，是一系列测试过程的总称，以逐渐实现对程序测试的覆盖。

* 语句覆盖（行覆盖、段覆盖、基本块覆盖）  
  * 基本思想：设计若干个测试用例，运行被测程序，使程序中**每一条可执行语句至少**应该**被执行一次**。  
  * 对程序代码覆盖率高、但对程序**执行逻辑的覆盖率很低**，是很弱的覆盖方式。
* 判定覆盖  
  * 基本思想：设计若干测试用率，使得**每个判定**都至少获得一次**真值或假值**（`case`语句则是判定结果每个都满足一次）。  
  * 满足了判定覆盖，也会满足语句覆盖，覆盖更强一些，但每个分支的所有状态不会被覆盖完。
* 条件覆盖
  * 基本思想：设计若干测试用例，使得每一个判定语句的每个**逻辑条件**可能**至少满足一次**。  
    最简单的方法，就2组，一组取任意逻辑，一组取反逻辑。
  * 满足条件覆盖不一定能满足分支覆盖，需要同志兼顾体偶案件覆盖和分支覆盖。
* 条件判定组合覆盖
  * *就是要同时满足判定覆盖和条件覆盖*
* 多条件覆盖
  * 基本思想：*就是真值表*，所有逻辑条件的所有取值情况都出现一次。
  * 最完全、但最复杂

#### (2) 基本路径测试法

用“控制流图”来描述程序控制流（程序流程方式），基本元素有：

* 节点：一般都以一判定语句划分节点
* 判定：判定条件处，这里一般都有分支
* 过程块：不能有判定（节点）分开的一组语句

根据”McCabe复杂性度量“，可以导出程序基本路径集合的独立路径条数，确保程序中每个可执行语句都至少执行一次。  
然后就按照“基本路径集合”设计测试用例，以让每条路径都被执行。

> McCabe复杂性度量：
>
> * $V(G) = $ 判断节点数 $+ 1$
> * $V(G)=  $ 边数 $-$ 顶点数 $+ 2$
>
> 独立路径数等于$V(G)$，测试的复杂性就是区域数。

---

## 性能测试

性能测试为了发现系统性能问题或获取系统性能相关指标而进行的测试。  
一般在真实环境、特定负载条件下，通过工具模拟环境进行测试。

**问题：**

1. 确定需求  
   * 有多少人会访问（容量）  
   * 并发量
   * 访问哪些业务（破坏点）
2. 保证系统健壮性  
   系统能在极端负载情况下正常运行
3. 制定意外处理方式  
   运行过程中有全面监控，对各种意外制定详细的应急方案  
   如高峰期增加服务器集群

**需求：**

* 用户体验需求：如“2-5-10原则”
* 商业需求：比竞争对手好
* 技术需求：如 CPU 使用率不超过 70%
* 标准要求：如数据通信延时 <80ms

**负载：**

* 每次请求发送的数据量
* 并发连接数
* 思考时间

**负载模式：**

* 一次加载方式
* 递增加载方式
* 突发加载方式

**分层模型：**

* 前端层：用户看到的页面
* 网络层：测试在不同网络状况的大流量下表现；要求将压力机和服务器最好放在同一网段
* 后端层：模拟大量客户端请求发送给后断层

**指标：**

* 响应时间
* 吞吐量
* 服务器资源占用

**流程：**

1. 制定性能测试目标：在线用户、并发、响应、资源使用率
2. 选择性能测试工具：LoadRunner、Jmeter
3. 设计性能测试：测试脚本、负载生成规则、监控、测试环境搭建
4. 监控分析系统：负载加载、分析结果数据、确定性能瓶颈
5. 性能优化：调优、重复测试