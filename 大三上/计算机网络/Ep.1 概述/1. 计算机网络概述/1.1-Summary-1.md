# 第一节 计算机网络概述

## 一、计算机网络相关

### 1. 定义

> 定义 - 计算机网络：
>
> 计算机网络是利用通信线路（联网设备）将**地理（逻辑）上分散**（虚拟机地理相同、但逻辑不同）的、具有独立功能的许多**计算机系统**连接起来，按照**某种协议**进行数据通信，以实现**资源共享**的信息系统。

*【书上原话】*网络是由若干**结点**(Node)和连接这些结点的**链路**(Link)组成。

多个网络还可以**通过路由器互连**起来，以构成覆盖范围更大的网络，即**互连网**(**internet**)，也称为“网络的网络”。  
其中**因特网**(**Internet**)就是**最大的互连网**，连接在因特网上的计算机称为主机(Host)。

**网络**把许多**计算机**连接在一起，而**互联网**则把许多**网络**通过路由器连接在一起。  
![网络](images/1.%20%E6%A6%82%E8%BF%B0--10-31_10-32-24.png)  

作用：

* 连接数以万计的设备（终端设备、PC、工作站、移动设备）
* 运行网络应用

一些设备：

* 通信线路（光(fiber)、铜(copper)、无线电(radio)、卫星(satellite)）
* 路由器(Routers)：通过网络转发数据报文。

> 了解 - 终端(terminal)：
>
> 终端相较于计算机而言，不具备计算能力，只是作为 IO 设备，断开与主机的连接后终端则不能工作。  
> 如以前银行的 ATM，只提供输入输出能力，处理都是在主机处理。  
> 还有计算机上用的字符终端和图形终端，用于远程连接计算机。

区别计算机网络与分布式系统：

* 计算机网络 - 自主计算机的互连集合。
* 分布式系统 - 软件开放的接口，运行在计算机网络之上的**软件系统**。

### 2. 局域网的组成部分

最早的局域网模型：  
![最早的局域网模型](images/1.%20%E6%A6%82%E8%BF%B0--09-07_11-55-06.png)

最早的局域网模型没采用 Hub，利用三通和堵头连接网络，  
但若一个设备出现问题，会导致整个系统崩溃。

之后利用集线器(Hub)连接，若一个设备出现问题会自动堵住问题端口，使得系统保持正常运行。

#### (1) 硬件

* 计算机
* 网络适配器（网卡）
* 网络互联设备：中继器、集线器、网桥、**交换机**、路由器、网关
  * LAN - 中继器、Hub、交换机
  * WAN/LAN-WAN：路由器
  * 不同协议系统之间互连：网关（如以太网和 NOVELL 网）
* 网络电缆和附属设备

包含**服务器**和**联网设备**：

* 服务器
  * Web 服务器
  * 电子邮件服务器
  * 域名服务器（将 IP 解析为域名）
  * FTP 服务器
  * 文件服务器
  * 数据库服务器
* 联网设备
  * 中继器：扩展线路
  * 集线器(Hub)
  * 交换机  
    与集线器的区别在于：Hub会均分带宽，而交换机都是一样的。

> 定义 - 服务器：
>
> 服务器是一台高性能计算机，用于**网络管理**、**运行应用程序**、**处理**各网络工作站成员的**信息请示**等，并**连接**一些共享的**外部设备**，如：打印机、CD-ROM、调制解调器等。

#### (2) 软件

* 网络**操作系统**(NOS)
* 网络设备**驱动程序**
* 网络**协议**及**协议软件**（Internet: TCP/IP; NOVELL: IPX/SPX）
* 网络**通信软件**
* 网络**管理**
* 网络**应用软件**（如防火墙等）

### 3. 结构

计算机网络划分为：

* 资源子网（**边缘部分**） - 由**主机**(Host)构成，所有资源都在这上面，用来进行资源通信和共享。
* 通信子网（**核心部分**） - 用来通信，由大量**网络**和**路由器**组成，为边缘部分提供服务。  
  包含若干转发结点，是用于转发数据包的专用计算机（即路由器）。

> 拓展 - 路由器：
>
> 在网络核心部分起特殊作用，是一种专用计算机，但不称它为主机。  
> 路由器是实现分组交换的关键构件，任务是转发收到的分组(Packet)。

![计算机网络结构](images/1.%20%E6%A6%82%E8%BF%B0--10-31_10-36-35.png)  
![因特网组成](images/1.%20%E6%A6%82%E8%BF%B0--10-31_11-30-19.png)

从层次结构上看，由三部分组成：

* 网络边界（端系统，即指主机和应用）  
  端系统则是运行应用程序的计算机，如www、Email。
* 网络核心（**主干网**，如路由器和网中网）
* **接入网**（通信链路和接入设备）

![计算机网络层次结构](images/1.%20%E6%A6%82%E8%BF%B0--11-01_16-21-11.png)

#### (1) 网络核心（主干网）

是由多个路由器连接而成的网络，  
基本功能为数据包的转发。

* 线路转发器(Circuit Switching)  
  给每个通信分配地专用线路。
* 包转发器(Packet Switching)  
  数据分组，独立地沿不同路线传输。

#### (2) 接入网

划分为以下部分：

* 住宅小区接入网
* 单位（如学校、公司）接入网
* 移动接入网

关注：

* 接入网的**带宽**（现在上传带宽更加重要，如微信朋友圈分享）
* 共享网络/专用网络

#### (3) 端系统通信方式

网络边缘的端系统之间，通信方式可划分为：

* **客户/服务器模式**(Client/Server model)  
  客户和服务器指通信中所涉及的两个**应用进程**（而不是用户(user)），  
  客户是服务请求方，服务器是服务提供方。  
  如：
  * WWW Client(Browser, 浏览器)/Server
  * Email Client/Server
* **对等连接方式**(Peer-to-Peer model, P2P)  
  两台机器直接在内网通信，跳过外网。  
  从本质上看仍是客户/服务器方式，不过所有端系统既可以是服务器也可以是客户。

> 拓展：
>
> 浏览器要求**隔离操作系统硬件**，因此浏览器的网络应用受限很大，如不能直接访问摄像头。

#### (4) 技术

* Modem拨号上网
* Dedicate：专线、DDN、FR
* ADSL（非对称DSL）：即下行和上行速度不一样

> 传统 Modem 与 xDSL技术的比较：
>
> * 传统 Modem：电话线与 Internet 接同一条线，频率一致，导致接入网络和打电话不能同时进行。
> * xDSL：将两者分开，上下行为两个高频、电话为低频，采用分离器分离。
>
> 用户内用 ADSL Modem 时，交换局也需要一个对应的Modem，为点对点式，  
> 因此交换局存在一个 Modem Pool。  
> ![图 1](images/1.%20%E6%A6%82%E8%BF%B0--09-14_11-03-58.png)

* LAN
* 无线接入网

家庭网络示意图：  
![图 3](images/1.%20%E6%A6%82%E8%BF%B0--09-14_11-12-02.png)  
路由器拨号后，就通过有线或无线(Wireless AP)分享流量。

### 4. 功能

* 资源共享(Resource Sharing)  
  包括软件、数据和硬件等资源的共享。（硬件的共享如打印机）
* 分散对象的实时集中控制和管理
* 均衡符合以及分布处理功能
* 综合信息服务功能
* 提高系统可靠性
* 节约开支
* 系统升级
* 数据传输、邮件、电子商务、远程教育、远程医疗等

### 5. ⭐分类

* ⭐按覆盖地理范围划分
  * **个人局域网**(**MAN**, PAN)
  * **局域网**(Local Area Network, **LAN**)（几公里以内）
  * 园区网(Campus Area Network)（十几公里）  
    在小范围内有大量的局域网
  * **城域网**(Metropolitan Area Network, **MAN**)  
    目前使用较少，因为小的运营商无之了
  * **广域网**(Wide Area Network, **WAN**)
* 按公用和专用划分
  * 公用网(Public Networks)  
    由电信部门、从事专门电信运营业务的公司，提供的**面向公众**服务的网络。
  * 专用网(Private Networks)  
    政府、行业、企业等单位为本行业、企业、事业单位服务而建立的网络，如教育科研网(CERNET)。
* 按 Internet 技术为基础的网络划分  
  Internet 的 TCP/IP 技术成为了建网的基本支撑技术
  * Internet（因特网）
  * Intranet（企业内网）
  * Extranet（企业外网）  
    提供企业内网对外的接口
* 按主要网络技术分类
  * 分组交换网 - X.25为基础
  * ATM 网 - 异步传输模式
  * 帧中继网 - 帧中继技术
  * 卫星网 - 卫星通信
* 按传播方式分类
  * 点到点网络
  * 广播式网络

### 6. ⭐网络拓扑结构

网络形状：  
![图 4](images/1.%20%E6%A6%82%E8%BF%B0--09-14_11-42-45.png)

* **星型**  
  每个计算机用单独线路与中央设备相连，  
  中央设备原来是计算机或集线器，现在是交换机或路由器。  
  优点：便于集中控制和管理  
  缺点：成本高，中央设备对故障敏感
* **环形**  
  计算机所有网络接口连接成一个环。  
  环中信号是单线传输的，可以是单环或双环。
* **总线型**  
  用单根传输线把计算机连接起来。  
  优点：建网容易、增减结点方便  
  缺点：重负载通信效率不高，任意一处出现故障全网瘫痪
* **网状型**（运营商与运营商骨干互联）  
  一般情况下每个结点至少有两条路径与其他结点相连。  
  优点：可靠性高  
  缺点：线路复杂、成本高
* 树型

## 二、因特网相关

### 1. 发展

* ARPANET
  * 对计算机网络定义
  * 分为资源子网和通信子网
  * 报文分组交换
* LAN  
  此时有很多标准，如：Ethernet、ARCNET等
* 网络标准化
  * ISO/OSI-RM
  * IEEE 802系列标准 - 局域网系列标准
  * CCITT(现为ITU-F)
  * TCP/IP标准
* Internet

![图 3](images/1.%20%E6%A6%82%E8%BF%B0--10-31_11-10-00.png)

> 拓展 - 因特网服务提供者(Internet Service Provider, ISP)：
>
> ISP可以从因特网管理机构申请到成块的IP地址，同时拥有通信线路和路由器等联网设备，  
> 任何机构和个人只要向ISP缴纳规定的费用，就可以从ISP得到所需要的IP地址，然后接入互联网。
>
> 我国的最大的ISP即：中国电信、联通、移动。
>
> ISP也分为三个层次：主干ISP、地区ISP和本地ISP。

### 2. 标准化工作

因特网的标准化工作，对因特网的发展起到非常重要的作用，  
存在一个可执行的标准，才能使得因特网得以发展。

因特网的标准的特点是**面向公众**。  
其中RFC技术文档可以从因特网上免费下载，且任何人都可随时发表对某个文档的建议。

> 扩展 - RFCs(Request for Comment)：
>
> Internert 的标准部分会从 [RFCs](https://www.ietf.org/standards/rfcs/) 中形成，  
> 若有人提出了一个建议，且支持的人多，则可能形成标准。

**因特网相关组织：**

* 因特网协会(ISOC) - 负责对因特网进行全面管理
* 因特网体系结构委员会(IAB) - 负责管理因特网有关协议的开发
* 因特网工程部(IETF) - 负责研究中短期工程问题，针对协议的开发和标准化
* 因特网研究部(IRTF) - 从事理论方面的研究和开发一些需要长期考虑的问题

![图 4](images/1.%20%E6%A6%82%E8%BF%B0--10-31_11-25-13.png)  

**制定因特网的正式标准的阶段：**

1. 因特网草案（此时还不是RFC文档）
2. 建议标准（形成RFC文档）
3. 草案标准
4. 因特网标准

## ⭐三、交换方式

三种：

* **电路交换**(Circuit Switching)
* **分组交换**(Packet Switching)
* **报文交换**

### 1. 电路交换

对于电话，若将所有电话两两相连是几乎不可能能，  
因此需要用**中间设备将所有电话连接起来**，即为“电话交换机”。

每一部电话都连接到电话交换机上，电话交换机将需要通信的两部电话按需接通。  
彼此相联的电话交换机完成全网的交换任务，构成覆盖全世界的电信网。

* 交换(Switching)：按照某种方式动态地分配传输线路的资源。

**步骤：**

1. 建立连接（分配通信资源，建立专用、不可占线物理通路）
2. 通话（一直占用通信资源）
3. 释放连接（归还通信资源）

线路传输效率很低，若未传输资源，但线路仍会被一直占用。

### 2. 分组交换

* 报文：表示该消息的整块数据。  
  发送数据前，先把报文分成若干更小的等长数据段。
* 分组（包）：划分后的数据段，在首部加上相应的控制信息后形成分组。  
  首部起着非常关键的作用，如指明目的地址。

**发送方完成的任务：**

* 构造分组
* 发送分组

**交换节点（路由器）完成的任务：**

* 缓存分组
* 转发分组

**接收方完成的任务：**

* 接收分组
* 还原报文

### 3. 报文交换

交换节点采用存储转发的方式，但**报文大小是没有限制的**（也就是报文是一次交换的**所有内容**，而分组交换则把报文分成更小的分组），  
故交换节点**需要较大（甚至无限）的缓存空间**，难以实现。

现在较少使用，被分组交换所取代。

### 4. 对比

![图 6](images/1.%20%E6%A6%82%E8%BF%B0--10-31_12-06-11.png)  
可看到分组交换就是把一个大报文拆分为了若干分组。

## ⭐四、性能指标

* 速率
* 带宽
* 吞吐量
* 时延
* 时延带宽积
* 往返时间
* 利用率
* 丢包率

### 1. 速率

首先计算机网络中传输数据的基本单位是比特(bit, b)，  
存在以下单位：

* 比特(bit, b)
* 字节(Byte, B) - $1\text{B} = 8b$
* 千字节(KiloByte, KB) - $1\text{KB} = 2^{10}\text{B} = 1024\text{B}$
* 兆字节(MB) - $1\text{MB} = 2^{10}\text{KB} = 1024\text{KB}$
* GB
* TB

> 拓展 - Kb, KB, KiB, kB：
>
> b和B的区分即是比特(1bit)和字节(8bit)的区分，  
> 而K和Ki的区别在于是十进制还是二进制，  
> $\text{K} = 10^3 = 1000$  
> $\text{Ki} = 2^{10} = 1024$
>
> 若给出K和k：K（数据量）一般指$1024$；k（数据率）一般指$1000$。

---

速率则是计算机网络上的主机，在数字信道上传送比特的速率，  
称为**比特率**或数据率。

基本单位：比特每秒(bit/s, bps)

* bit/s(b/s, bps)
* **k**b/s(Kbps) - $= 10^3\text{bps}$
* **M**b/s(Mbps) - $= 10^6\text{bps}$（这里写作大写只是为了好看x，实际上跟上面的kb/s一样）
* **G**b/s(Gbps) - $= 10^9\text{bps}$
* **T**b/s(Tbps)

若计算传输用时，严格来说数据量中的K,M和数据率中的k,M是不能约掉的，值为$2^{10}/10^3=1.04$，  
但差别不大，估算时可直接约掉。

但一定注意$1B=8b$。

### 2. 带宽

> 拓展 - 带宽在模拟信号系统中的意义：
>
> 在模拟信号系统中，指信号所包含的各种不同频率成分，所占据的**频率范围**。  
>
> 基本单位：赫兹(Hz)
>
> * Hz
> * **k**Hz
> * MHZ（M大写同上）
> * GHz
>
> 如电话的带宽是300Hz~3.4kHz。

在计算机网络中指：表示网络的通信线路所能传送数据的能力。  
即在**单位时间内**，从网络某一点到另一点所**能通过的最高数据率**。

单位与速率单位一致：

* bit/s(b/s, bps)
* **k**b/s(Kbps)
* **M**b/s(Mbps)
* **G**b/s(Gbps)
* **T**b/s(Tbps)

### 3. 吞吐量

**单位时间内**，通过某个网络（或信道、接口）的**实际数据量**。  
是用于对现实世界中的网络的一种测量，以便实际知道有多少数据能够通过网络。

受网络的带宽或额定速率的限制，通常小于带宽。

### 4. 时延

传输过程中产生的延迟。

* **发送时延** - 源主机将分组发往传输线路  
  **计算公式**：分组长度(b)$/$发送速率(b/s)  
  其中理论发送速率，是“网卡的发送速率”、“信道的带宽”和“（交换机/路由器的）接口速率”三者最小值。  
  ![发送速率](images/1.%20%E6%A6%82%E8%BF%B0--10-31_12-59-44.png)
* **传播时延** - 分组在链路上传输，会有多次  
  **计算公式**：信道长度(m)$/$电磁波传输速率(m/s)
  * 自由空间电磁波传播速率：$3\times 10^8\text{m/s}$
  * 铜线：$2.3\times 10^8\text{m/s}$
  * 光纤：$2\times 10^8\text{m/s}$
* 处理时延 - 路由器收到分组后，对其进行存储转发，会有多次  
  不方便计算。

在**数据块长度较小**时，**传播时延**占主导；而**较大**时，**发送时延**占主导。

### 5. 时延带宽积

**传播时延**与**带宽**的乘积。  
发送的第一个比特到达终点时，发送端已发送了“时延带宽积”个比特。  
又称“以比特位单位的链路长度”。

### 6. 往返时间

因特网的信息很多时候是双向交互，需要知道双向交互一次的时间。
指：从源主机发送分组开始，到源主机收到到目的主机的确认分组的时间。

### 7. 利用率

* 信道利用率：表示某信道中有百分之几的时间是被利用的（有数据通过）
* 网络利用率：全网络的信道利用率的加权平均。

当某信道的利用率增大时，该信道引起的时延也会增加。

$D_0$表示网络空闲时延，$U$表示利用率，则：

$$
D=\frac{D_0}{1-U}
$$

故信道利用率并非越高越好（类似于CPU利用率，越高说明CPU越差）；  
也不能太低，不然浪费资源。

### 8. 丢包率

丢包率即“分组丢失率”，指一定的时间范围内，传输过程中丢失的分组数量与总分组数量的比率。

可分为：

* 接口丢包率
* 结点丢包率
* 链路丢包率
* 路径丢包率
* 网络丢包率

丢包率对网络运维人员非常关心，但对普通用户不关心，因为感受不到（网络会进行丢包重发等操作）。

**分组丢失的情况：**

* 传输过程中出现**误码**，被结点丢弃。
* 分组到达一台**队列已满**的分组交换机，故被丢弃。  
  因此丢包率也一定程度反映了网络**拥塞情况**，丢包率为$5\%\sim15\%$时即为严重拥塞。
