# 第一节 估计

估计，顾名思义，不知道总体的全部信息，部分信息需要通过抽样得到样本信息估计出来，  
分为参数估计与非参数估计：

* 参数估计：总体$X$的**分布已知**，但参数不知道。  
  *注：总体参数指对于总体服从的分布（正态、泊松等）的参数（正态就是$\mu,\sigma$）。*  
  比如：知道$X$服从正态分布$N(\mu,\sigma^2)$，但$\mu,\sigma^2$不知道具体是多少。
* 非参数估计：连总体$X$的**分布都不知道**了。

---

本章的问题**属于参数估计**，  
需要通过**取样本**的方法，**估计总体的各种参数$\theta_i$**。

估计的方法：

1. 点估计
2. 区间估计

## 一、点估计

> 构造一个有关样本统计量的函数，  
> 使得通过样本，估计出总体参数。
>
> 即为：$\hat{\theta}=f(X_1,X_2,\cdots,X_n)$，  
> $\hat{\theta}$为$\theta$的点估计量。

方法：

1. 矩估计
2. 极大似然估计
3. 最小二乘估计
4. 贝叶斯估计
5. 极大极小估计

### 1. 矩估计

用样本的矩来估计（代替）总体的矩。

> 定义 - 矩的概念：
>
> ...
> 
> 1. 原点矩  
>    理论（总体）：
>    $$
>    E\left(X^{k}\right)=\left\{\begin{array}{l}
>    \sum\left(x_{i}\right)^{k} p( x_{i}) \\
>    \int_{-\infty}^{+\infty} x^{k} f(x) \textrm{d} x
>    \end{array}\right.
>    $$
>    样本：
>    $$
>    \frac{1}{n} \sum x_{i}^{k}
>    $$
>    即为$\overline{X}$
> 2. 中心矩  
>    理论（总体）：
>    $$
>    E(X-EX)^{k}=\left\{\begin{array}{l}
>    \sum\left(x_{i}-EX)^{k} p\left(x_{i}\right)\right. \\
>    \int_{-\infty}^{+\infty}\left(x-EX)^{2} f(x) \textrm{d} x\right.
>    \end{array}\right.
>    $$
>    样本：
>    $$
>    \frac{1}{n} \sum\left(x_{i}-\overline{X}\right)^{k}
>    $$
>    记作：$S_n^{*k}$，为$k$阶中心矩
>
>    对于不同的$k$：
>
>    * $k=1$
>    * $k=2$
>    * $k=3$ - 偏度
>    * $k=4$ - 峰度
>
>    偏度和峰度刻画分布。
>
>    *记忆：中心矩，记为与中心的偏差，所以为$\sum (x_i-\overline{X})^k$*

*虽然需要的矩个数会根据参数个数增多而增多，但实际做题最多只用两个矩。*

矩估计则是：  
样本的一阶矩$A_1$等于总体的一阶矩$EX$，  
样本的二阶矩$A_2$等于总体的二阶矩$EX^2$；  
样本的$k$阶矩$A_k$等于总体的k阶矩$EX^k$。

但一般分布的参数只有一个或两个，所以最多到二阶矩。

* 一个参数的分布：只用到一阶矩$\theta_1=A_1=\overline{X}$。
* 两个参数的分布：用到一二阶矩，如下，  
  $\left\{\begin{array}{ll}
  E X&\Leftarrow A_1&=\frac{1}{n}\sum x_i&=\overline{X} \\
  E X^{2}=E^{2} X+D X&\Leftarrow A_2&=\frac{1}{n}\sum x_i^2
  \end{array}\right.$  
  其中$EX$、$EX^2$可以用两个参数的估计值表示。  
  > e.g.
  >
  > * 正态：$EX=\hat\mu$，$EX^2=\hat\mu^2+\hat\sigma^2$
  > * 泊松：$EX=\hat\lambda$，$EX^2=\hat\lambda+\hat\lambda^2$

对于估计值，需要在头上加一个^，  
**代表这个是估计值$\hat{\theta}$**，区别于准确值$\theta$。

---

⭐总结 - 即矩估计：
$$
EX=\overline{X} \\
DX=S_n^{*2}
$$
其中$S_n^{*2}=\frac{1}{n} \sum\left(x_{i}-\overline{x}\right)^{2}$，为样本二姐中心矩

* 总体均值估计量：样本均值
* 总体方差估计量：样本二阶中心矩

有几个参数，取多少个$k$。  
注意如果不为关于参数的函数（如算出来为参数），需要取不同的$k$。

---

性质：

矩估计复合函数后，仍为复合后的矩估计。  
如$S_n^{*2}$为总体方差$D(X)$的矩估计量，  
这$\sqrt{S_n^{*2}}=S_n^*$为标准差$\sqrt{D(X)}$的矩估计量。

### 2. 极大似然估计

基于原理：**小概率事件**在**一次观测**中**不可能发生**。  
那么反之，如果在一次观测中某一事件发生了，那么这个事件的可能性就很大。
> e.g.
>
> 一个箱子A有1个白球99个黑球，另一个箱子B有99个白球1个黑球，  
> 现在知道某位同学（**一次观测**）摸到了一个白球，  
>
> 那么估计：这个同学是从B箱例摸的。  
> 因为A箱白球很少（**小概率事件**），在这一次摸的情况下几乎不可能是A箱摸到的（**不可能发生**）。

基于这一原理，得到了总体的某个样本（一次观测），那么取样得到这个样本的可能性就很大，  
因此就要调整各个参数$\theta_i$（也就是估计参数），满足这个样本出现的可能性很大。

自然想到**构造**关于这个**样本与各参数的一个函数**，代表这个样本出现的概率，  
然后**求这个函数的极大值**，来确定各个参数。  
这个函数即叫“似然函数”。

---

似然函数的构造：

* 自变量 - 确定部分：样本的观察值$X=(x_1,x_2,\cdots,x_n)$
* 自变量 - 估计（求解）部分：总体的参数$\Theta=(\theta_1,\theta_2,\cdots,\theta_n)$
* 因变量 - 这个样本的出现概率
* 法则：
  $$
  f(X,\Theta)=p(X_1,\Theta)\times p(X_2,\Theta) \times \cdots \times p(X_n,\Theta)
  $$
  就是各个取值的概率乘积。

但为了使得极大值（求导）好求，通常采用对数似然函数。

---

步骤：

1. 求似然函数：$L(x_1,\cdots;\theta_1,\cdots)$
2. 求对数：$\ln L(x_1,\cdots;\theta_1,\cdots)$
3. 对参数求偏导：$\frac{\textrm{d}(\ln L(\cdots))}{\textrm{d}\theta}$  
   对不同的$\theta_i$求偏导，解出来的$n$个极大值即为$\theta$的极大似然估计。

---

性质：极大似然估计的函数仍是其极大似然估计。

## ？、 对矩估计的评价

### 1. 无偏性

总体参数的真值：$\theta=(\theta_1,\theta_2,\cdots)^T$  
总体参数的估计量：$\hat{\theta}=(\hat{\theta}_1,\hat{\theta}_2,\cdots)^T$

若$E\hat(\theta)=\theta$，则称无偏估计。

1. 期望：$EX=\mu$，为无偏
2. 方差：$ES_n^{*2}=\frac{n-1}{n}\sigma^2\ne\sigma^2$，为有偏估计。  
   因此对于$S_n^2=\frac{1}{n-1}\sum (X_i-\overline{X})^2$，才为无偏估计。

### 2. 有效性

在无偏的前提下，计算$\hat\theta$的方差，  
方差越小越有效。